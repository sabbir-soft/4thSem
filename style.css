/* ==========================================================================
   Project: 4th Semester Question Analyzer — ADVANCED v2.0
   Theme: Premium Glassmorphism + Soft Depth
   Font: Hind Siliguri + Baloo Da 2
   ========================================================================== */

/* ── বাংলা ফন্ট: Kalpurush ── */
@font-face {
    font-family: 'Kalpurush';
    src: url('kalpurush.woff2') format('woff2');
    font-weight: 400 700;
    font-style: normal;
    font-display: swap;
    unicode-range: U+0980-09FF, U+200C-200D, U+25CC;
}

/* ── ইংরেজি ফন্ট: Inter ── */
@font-face {
    font-family: 'Inter';
    src: url('Inter_18pt-Regular.woff2') format('woff2');
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC,
                   U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329,
                   U+2000-206F, U+2074, U+20AC, U+2122, U+2191,
                   U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
    font-family: 'Inter';
    src: url('Inter_18pt-SemiBold.woff2') format('woff2');
    font-weight: 600;
    font-style: normal;
    font-display: swap;
    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC,
                   U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329,
                   U+2000-206F, U+2074, U+20AC, U+2122, U+2191,
                   U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
    font-family: 'Inter';
    src: url('Inter_18pt-Bold.woff2') format('woff2');
    font-weight: 700;
    font-style: normal;
    font-display: swap;
    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC,
                   U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329,
                   U+2000-206F, U+2074, U+20AC, U+2122, U+2191,
                   U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
   *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
    --bg: #f0f2fa;
    --bg2: #e6e9f4;
    --surface: #f0f2fa;
    --surface-2: #f8f9ff;
    --shadow-dark: #c5c8d6;
    --shadow-light: #ffffff;
    --text: #2d3152;
    --text-2: #5a6380;
    --text-3: #98a0b8;
    --accent: #5b5ef4;
    --accent-2: #8b5cf6;
    --accent-3: #06b6d4;
    --accent-4: #10b981;
    --accent-warm: #f59e0b;
    --accent-rose: #f43f5e;
    --card-r: 20px;
    --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    /* Reading-friendly */
    --reading-bg: #fafbff;
    --reading-text: #1e2340;
    --answer-bg: rgba(91,94,244,0.03);
}

body.dark {
    --bg: #0f1117;
    --bg2: #161925;
    --surface: #1a1d2e;
    --surface-2: #21253a;
    --shadow-dark: #090b12;
    --shadow-light: #252840;
    --text: #e8edf8;
    --text-2: #8b9ab8;
    --text-3: #556080;
    --accent: #7c7ff5;
    --accent-2: #a78bfa;
    --accent-3: #22d3ee;
    --accent-4: #34d399;
    --reading-bg: rgba(30,33,50,0.6);
    --reading-text: #dce4f5;
    --answer-bg: rgba(124,127,245,0.04);
}

html { scroll-behavior: smooth; }

body {
    font-family: 'Kalpurush', 'Inter', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    transition: background var(--transition), color var(--transition);
}

/* ---- SCROLLBAR ---- */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: var(--bg); }
::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 99px; }

/* ---- BACKGROUND ---- */
.bg-glow {
    position: fixed; inset: 0; pointer-events: none; z-index: 0;
    overflow: hidden;
}
.bg-glow::before {
    content: '';
    position: absolute;
    width: 700px; height: 700px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(91,94,244,0.1) 0%, transparent 68%);
    top: -150px; left: -150px;
    animation: glowMove1 18s ease-in-out infinite alternate;
}
.bg-glow::after {
    content: '';
    position: absolute;
    width: 500px; height: 500px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(6,182,212,0.07) 0%, transparent 70%);
    bottom: 5%; right: -80px;
    animation: glowMove2 22s ease-in-out infinite alternate;
}
body.dark .bg-glow::before {
    background: radial-gradient(circle, rgba(124,127,245,0.12) 0%, transparent 68%);
}
body.dark .bg-glow::after {
    background: radial-gradient(circle, rgba(34,211,238,0.08) 0%, transparent 70%);
}
@keyframes glowMove1 { 0%{transform:translate(0,0) scale(1)} 100%{transform:translate(120px,90px) scale(1.1)} }
@keyframes glowMove2 { 0%{transform:translate(0,0) scale(1)} 100%{transform:translate(-90px,-70px) scale(1.08)} }

/* ---- NEUMORPHIC CARD ---- */
.card {
    background: var(--surface);
    border-radius: var(--card-r);
    box-shadow: -8px -8px 16px var(--shadow-light), 8px 8px 16px var(--shadow-dark);
    transition: box-shadow var(--transition), background var(--transition);
    position: relative;
    overflow: hidden;
}
.card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
    pointer-events: none;
}
body.dark .card {
    box-shadow: -6px -6px 12px var(--shadow-light), 6px 6px 14px var(--shadow-dark);
}
body.dark .card::before {
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.06), transparent);
}

/* ---- GLASS CARD ---- */
.glass-card {
    background: rgba(255,255,255,0.55);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border: 1px solid rgba(255,255,255,0.5);
    border-radius: var(--card-r);
    box-shadow: 0 8px 32px rgba(99,102,241,0.08), 0 2px 8px rgba(0,0,0,0.06);
    transition: all var(--transition);
}
body.dark .glass-card {
    background: rgba(30,34,53,0.7);
    border-color: rgba(255,255,255,0.07);
}

/* ---- HEADER ---- */
header {
    position: relative;
    z-index: 10;
    padding: 2rem 1rem 1rem;
}
.header-badge {
    display: inline-block;
    font-size: 0.7rem;
    font-weight: 700;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 0.3rem 0.9rem;
    border-radius: 99px;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color: #fff;
    margin-bottom: 0.75rem;
    box-shadow: 0 4px 12px rgba(99,102,241,0.35);
}
header h1 {
    font-family: 'Kalpurush', 'Inter', sans-serif;
    font-size: clamp(1.6rem, 5vw, 2.8rem);
    font-weight: 700;
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 50%, var(--accent-3) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1.4;
    text-align: center;
}
header p.subtitle {
    color: var(--text-2);
    font-size: clamp(0.85rem, 2.5vw, 1rem);
    text-align: center;
    margin-top: 0.4rem;
}

/* ---- TOP NAV BAR (sticky) ---- */
#top-sticky-bar {
    position: sticky;
    top: 0;
    z-index: 100;
    /* FIX: backdrop-filter সব Android Chrome-এ কাজ করে না
       তাই solid fallback background আগে দিতে হবে */
    background: rgba(240,242,250,0.97);
    border-bottom: 1px solid rgba(255,255,255,0.5);
    box-shadow: 0 2px 16px rgba(91,94,244,0.07), 0 1px 0 rgba(255,255,255,0.4);
    transition: all var(--transition);
    padding: 0.6rem 1rem;
}
@supports (backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px)) {
    #top-sticky-bar {
        background: rgba(240,242,250,0.88);
        backdrop-filter: blur(24px) saturate(1.5);
        -webkit-backdrop-filter: blur(24px) saturate(1.5);
    }
}
body.dark #top-sticky-bar {
    background: rgba(15,17,23,0.97);
    border-bottom-color: rgba(124,127,245,0.1);
    box-shadow: 0 2px 16px rgba(0,0,0,0.4), 0 1px 0 rgba(124,127,245,0.06);
}
@supports (backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px)) {
    body.dark #top-sticky-bar {
        background: rgba(15,17,23,0.92);
        backdrop-filter: blur(24px) saturate(1.5);
        -webkit-backdrop-filter: blur(24px) saturate(1.5);
    }
}
#top-sticky-bar .inner {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    flex-wrap: wrap;
}

/* ---- SEARCH BAR ---- */
.search-wrap {
    position: relative;
    flex: 1;
    min-width: 200px;
    max-width: 420px;
}
.search-wrap svg {
    position: absolute;
    left: 14px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-3);
    pointer-events: none;
    flex-shrink: 0;
}
#global-search {
    width: 100%;
    padding: 0.65rem 1rem 0.65rem 2.6rem;
    border: none;
    border-radius: 99px;
    background: var(--surface);
    color: var(--text);
    font-family: 'Kalpurush', 'Inter', sans-serif;
    font-size: 0.9rem;
    outline: none;
    box-shadow: inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light);
    transition: all var(--transition);
}
#global-search:focus {
    box-shadow: inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light), 0 0 0 2px var(--accent);
}
#global-search::placeholder { color: var(--text-3); }
#search-results-dropdown {
    position: absolute;
    top: calc(100% + 8px);
    left: 0; right: 0;
    background: var(--surface-2);
    border-radius: 16px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.15), 0 0 0 1px rgba(99,102,241,0.15);
    z-index: 200;
    overflow: hidden;
    max-height: 70vh;
    overflow-y: auto;
}
.search-result-item {
    padding: 0.9rem 1.1rem;
    cursor: pointer;
    border-bottom: 1px solid rgba(0,0,0,0.05);
    transition: background var(--transition);
}
body.dark .search-result-item { border-bottom-color: rgba(255,255,255,0.04); }
.search-result-item:hover { background: rgba(99,102,241,0.08); }
.search-result-item:focus { background: rgba(99,102,241,0.1); outline: none; }
.search-result-item.focused { background: rgba(99,102,241,0.1); }
.search-result-item:last-child { border-bottom: none; }
.search-result-item .sr-tag {
    font-size: 0.65rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    padding: 0.15rem 0.5rem;
    border-radius: 99px;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color: #fff;
    margin-right: 0.5rem;
    display: inline-block;
}
.search-result-item .sr-q {
    font-size: 0.88rem;
    color: var(--text);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    margin-top: 0.3rem;
}
.search-result-item .sr-meta {
    font-size: 0.72rem;
    color: var(--text-3);
    margin-bottom: 0.2rem;
}
.search-empty {
    text-align: center;
    padding: 2rem;
    color: var(--text-3);
    font-size: 0.9rem;
}
mark {
    background: rgba(99,102,241,0.2);
    color: var(--accent);
    border-radius: 3px;
    padding: 0 2px;
}

/* ---- NAV BUTTONS ---- */
.neu-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.55rem 1.15rem;
    border-radius: 99px;
    border: 1.5px solid transparent;
    background: var(--surface);
    color: var(--text-2);
    font-family: 'Kalpurush', 'Inter', sans-serif;
    font-weight: 600;
    font-size: 0.88rem;
    cursor: pointer;
    box-shadow:
        -4px -4px 8px var(--shadow-light),
        4px 4px 8px var(--shadow-dark),
        0 1px 2px rgba(0,0,0,0.05);
    transition: color 0.22s ease, box-shadow 0.22s ease,
                transform 0.18s ease, border-color 0.22s ease,
                background 0.22s ease;
    white-space: nowrap;
    flex-shrink: 0;
    position: relative;
    overflow: hidden;
    -webkit-tap-highlight-color: transparent;
    letter-spacing: 0.01em;
}
/* Shimmer overlay on hover */
.neu-btn::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(105deg,
        transparent 40%,
        rgba(255,255,255,0.12) 50%,
        transparent 60%);
    transform: translateX(-100%);
    transition: transform 0.5s ease;
    border-radius: inherit;
    pointer-events: none;
}
.neu-btn::after {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center, rgba(99,102,241,0.14) 0%, transparent 70%);
    opacity: 0;
    transition: opacity 0.35s ease;
    border-radius: inherit;
    pointer-events: none;
}
@media (hover: hover) {
    .neu-btn:hover {
        color: var(--accent);
        border-color: rgba(99,102,241,0.22);
        box-shadow:
            -5px -5px 10px var(--shadow-light),
            5px 5px 10px var(--shadow-dark),
            0 0 0 2.5px rgba(99,102,241,0.15),
            0 4px 12px rgba(99,102,241,0.12);
        transform: translateY(-1.5px);
    }
    .neu-btn:hover::after { opacity: 1; }
    .neu-btn:hover::before { transform: translateX(100%); }
}
.neu-btn:active { transform: translateY(1px) scale(0.975); box-shadow: -2px -2px 5px var(--shadow-light), 2px 2px 5px var(--shadow-dark); }
.neu-btn.active {
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%);
    color: #fff;
    border-color: transparent;
    box-shadow:
        0 6px 20px rgba(99,102,241,0.38),
        0 2px 6px rgba(99,102,241,0.25),
        inset 0 -1.5px 0 rgba(0,0,0,0.18),
        inset 0 1px 0 rgba(255,255,255,0.15);
    transform: translateY(0.5px);
}
.neu-btn.active::after,
.neu-btn.active::before { display: none; }
body.dark .neu-btn {
    background: var(--surface);
    color: var(--text-2);
    box-shadow:
        -4px -4px 8px var(--shadow-light),
        4px 4px 8px var(--shadow-dark);
}
body.dark .neu-btn:hover {
    border-color: rgba(124,127,245,0.28);
    box-shadow:
        -5px -5px 10px var(--shadow-light),
        5px 5px 10px var(--shadow-dark),
        0 0 0 2.5px rgba(124,127,245,0.18),
        0 4px 14px rgba(0,0,0,0.3);
}

/* Ripple animation */
@keyframes ripple {
    0% { transform: scale(0); opacity: 0.5; }
    100% { transform: scale(4); opacity: 0; }
}
.ripple-effect {
    position: absolute;
    border-radius: 50%;
    background: rgba(99,102,241,0.3);
    width: 20px; height: 20px;
    margin-top: -10px; margin-left: -10px;
    animation: ripple 0.6s linear;
    pointer-events: none;
}

/* ---- SUBJECT NAV ---- */
#subject-nav {
    position: relative;
    z-index: 10;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.6rem;
    padding: 0.75rem 1rem;
    max-width: 1200px;
    margin: 0.5rem auto;
}
#subject-nav .neu-btn { font-size: 0.85rem; padding: 0.5rem 1rem; }

/* ---- STATS BAR ---- */
#stats-bar {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    gap: 1rem;
    padding: 0 1rem;
    max-width: 1200px;
    margin: 0 auto 1.5rem;
}
.stat-item {
    background: var(--surface);
    border-radius: 16px;
    padding: 1rem 1.2rem;
    text-align: center;
    box-shadow: -6px -6px 12px var(--shadow-light), 6px 6px 12px var(--shadow-dark);
    transition: all var(--transition);
}
.stat-item:hover { transform: translateY(-3px); }
.stat-item .s-num {
    font-family: 'Inter', sans-serif;
    font-size: 1.8rem;
    font-weight: 700;
    line-height: 1;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
.stat-item .s-label { font-size: 0.75rem; color: var(--text-2); margin-top: 0.3rem; }

/* ---- FEATURE CARDS (intro) — base styles; see v4.0 section for complete redesign ---- */
.feature-card-linked:active { transform: translateY(-2px) scale(0.98); }
.feature-card-arrow {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 28px; height: 28px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color: #fff;
    margin: 0.6rem auto 0;
    box-shadow: 0 3px 10px rgba(91,94,244,0.35);
    transition: all var(--transition);
    opacity: 0.7;
}
.feature-card-linked:hover .feature-card-arrow {
    opacity: 1;
    transform: translateX(3px);
    box-shadow: 0 5px 14px rgba(91,94,244,0.5);
}
/* Legacy icon-container: kept for any existing usage */
.icon-container {
    width: 60px; height: 60px;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    margin: 0 auto 0.75rem;
    box-shadow: -4px -4px 8px var(--shadow-light), 4px 4px 8px var(--shadow-dark);
    transition: all var(--transition);
}
.feature-card-linked:hover .icon-container { transform: scale(1.1) rotate(-4deg); }
.feature-card h3 { font-size: 1rem; font-weight: 700; margin-bottom: 0.5rem; color: var(--text); }
.feature-card p { font-size: 0.82rem; color: var(--text-2); line-height: 1.5; }



/* ---- FILTER SECTION ---- */
#filter-section { padding: 0 1rem; max-width: 1200px; margin: 0 auto; width: 100%; }
.filter-wrap {
    background: var(--surface);
    border-radius: 20px;
    padding: 0.9rem 1.25rem;
    box-shadow:
        -6px -6px 12px var(--shadow-light),
        6px 6px 12px var(--shadow-dark),
        0 1px 3px rgba(0,0,0,0.06);
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.85rem;
    justify-content: space-between;
    border: 1.5px solid rgba(91,94,244,0.06);
}
body.dark .filter-wrap { border-color: rgba(124,127,245,0.1); }
.filter-group { display: flex; align-items: center; gap: 0.55rem; flex-wrap: wrap; }
.filter-group label {
    font-size: 0.82rem;
    font-weight: 700;
    color: var(--text-3);
    display: flex; align-items: center; gap: 0.3rem;
    text-transform: uppercase;
    letter-spacing: 0.04em;
}
select.neu-select {
    padding: 0.48rem 2rem 0.48rem 0.9rem;
    border: 1.5px solid rgba(91,94,244,0.1);
    border-radius: 99px;
    background: var(--surface);
    color: var(--text);
    font-family: 'Kalpurush', 'Inter', sans-serif;
    font-size: 0.88rem;
    font-weight: 600;
    cursor: pointer;
    outline: none;
    box-shadow: inset 2px 2px 5px var(--shadow-dark), inset -2px -2px 5px var(--shadow-light);
    transition: border-color 0.22s ease, box-shadow 0.22s ease;
    -webkit-appearance: none; appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%236366f1' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.7rem center;
}
select.neu-select:focus { border-color: rgba(99,102,241,0.4); box-shadow: inset 2px 2px 5px var(--shadow-dark), inset -2px -2px 5px var(--shadow-light), 0 0 0 3px rgba(99,102,241,0.12); }
body.dark select.neu-select { border-color: rgba(124,127,245,0.15); }

.mcq-score-badge {
    display: flex; align-items: center; gap: 0.5rem;
    padding: 0.42rem 1.15rem;
    border-radius: 99px;
    background: var(--surface);
    color: var(--accent);
    font-size: 0.83rem;
    font-weight: 700;
    letter-spacing: 0.03em;
    box-shadow:
        -4px -4px 8px var(--shadow-light),
        4px 4px 8px var(--shadow-dark),
        inset 0 0 0 1.5px rgba(99,102,241,0.25);
    transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
    position: relative;
    overflow: hidden;
}
.mcq-score-badge::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(99,102,241,0.12) 0%, rgba(139,92,246,0.08) 100%);
    border-radius: inherit;
    pointer-events: none;
}
body.dark .mcq-score-badge {
    color: #a5b4fc;
    box-shadow:
        -3px -3px 7px var(--shadow-light),
        3px 3px 7px var(--shadow-dark),
        inset 0 0 0 1.5px rgba(139,92,246,0.3);
}
body.dark .mcq-score-badge::before {
    background: linear-gradient(135deg, rgba(99,102,241,0.18) 0%, rgba(139,92,246,0.12) 100%);
}
/* ---- PROGRESS BAR (MCQ) ---- */
#mcq-progress-bar-wrap {
    width: 100%;
    height: 4px;
    background: var(--shadow-dark);
    border-radius: 99px;
    overflow: hidden;
    margin-top: 0.5rem;
}
#mcq-progress-bar {
    height: 100%;
    border-radius: 99px;
    background: linear-gradient(90deg, var(--accent), var(--accent-2));
    transition: width 0.5s ease;
    width: 0%;
}

/* ---- CHART ---- */
#chart-section { padding: 0 1rem; max-width: 1200px; margin: 0 auto 1.5rem; width: 100%; }
.chart-container {
    position: relative;
    height: 280px;
    max-height: 300px;
}
@media (min-width: 768px) { .chart-container { height: 340px; } }

/* ---- QUESTION DISPLAY ---- */
#question-display { padding: 0 1rem 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }

/* ---- ACCORDION ---- */
.q-accordion {
    background: var(--surface);
    border-radius: 18px;
    box-shadow: -5px -5px 10px var(--shadow-light), 5px 5px 10px var(--shadow-dark);
    overflow: hidden;
    transition: all 0.35s cubic-bezier(0.4,0,0.2,1);
    border: 1.5px solid transparent;
    contain: layout style;
}
.q-accordion + .q-accordion { margin-top: 0.85rem; }
.q-accordion:hover {
    box-shadow: -7px -7px 14px var(--shadow-light), 7px 7px 14px var(--shadow-dark);
    border-color: rgba(91,94,244,0.12);
    transform: translateY(-2px);
}
.q-accordion.is-open {
    border-color: rgba(91,94,244,0.25);
    box-shadow: -4px -4px 10px var(--shadow-light), 4px 4px 10px var(--shadow-dark),
                0 0 0 1px rgba(91,94,244,0.12),
                0 12px 32px rgba(91,94,244,0.12);
    transform: translateY(0);
}
body.dark .q-accordion.is-open {
    border-color: rgba(124,127,245,0.3);
    box-shadow: -3px -3px 8px var(--shadow-light), 3px 3px 8px var(--shadow-dark),
                0 0 0 1px rgba(124,127,245,0.15),
                0 12px 32px rgba(124,127,245,0.15);
}
.q-header {
    width: 100%;
    background: none;
    border: none;
    padding: 1rem 1.25rem;
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 0.75rem;
    cursor: pointer;
    text-align: left;
    color: var(--text);
    font-family: 'Kalpurush', 'Inter', sans-serif;
    font-size: 0.95rem;
    font-weight: 600;
    line-height: 1.65;
    transition: color 0.25s ease, padding-left 0.25s ease;
    position: relative;
    -webkit-tap-highlight-color: transparent;
}
.q-header::before {
    content: '';
    position: absolute;
    left: 0; top: 18%; bottom: 18%;
    width: 3.5px;
    border-radius: 99px;
    background: linear-gradient(to bottom, var(--accent), var(--accent-2));
    opacity: 0;
    transition: opacity 0.25s ease, transform 0.25s ease;
    transform: scaleY(0.5);
}
.q-header:hover::before, .q-header.active::before {
    opacity: 1;
    transform: scaleY(1);
}
@media (hover: hover) {
    .q-header:hover { color: var(--accent); padding-left: 1.5rem; }
}
.q-header.active { color: var(--accent); padding-left: 1.5rem; }
.q-num-badge {
    flex-shrink: 0;
    width: 28px; height: 28px;
    border-radius: 8px;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color: #fff;
    font-size: 0.72rem;
    font-weight: 700;
    display: flex; align-items: center; justify-content: center;
    box-shadow: 0 3px 8px rgba(99,102,241,0.35);
    transition: all var(--transition);
}
.q-header:hover .q-num-badge, .q-header.active .q-num-badge {
    transform: rotate(-5deg) scale(1.1);
    box-shadow: 0 4px 12px rgba(99,102,241,0.5);
}
.q-chevron {
    flex-shrink: 0;
    width: 24px; height: 24px;
    border-radius: 50%;
    background: var(--bg2);
    display: flex; align-items: center; justify-content: center;
    transition: transform var(--transition), background var(--transition), box-shadow var(--transition);
    box-shadow: -2px -2px 4px var(--shadow-light), 2px 2px 4px var(--shadow-dark);
    color: var(--text-2);
}
.q-header:hover .q-chevron { background: rgba(99,102,241,0.1); color: var(--accent); }
.q-header.active .q-chevron { transform: rotate(180deg); background: linear-gradient(135deg, var(--accent), var(--accent-2)); color: #fff; box-shadow: 0 3px 10px rgba(99,102,241,0.4); }
.q-body {
    display: grid;
    grid-template-rows: 0fr;
    transition: grid-template-rows 0.42s cubic-bezier(0.4,0,0.2,1),
                opacity 0.32s ease,
                padding 0.32s ease;
    padding: 0 1.25rem;
    opacity: 0;
}
.q-body > * {
    overflow: hidden;
    min-height: 0;
}
.q-body.open {
    grid-template-rows: 1fr;
    padding: 0 1.5rem 1.5rem;
    opacity: 1;
}

/* ---- ANSWER CONTENT ---- */
.answer-content {
    font-size: 0.96rem;
    line-height: 1.85;
    color: var(--reading-text, var(--text));
    background: var(--answer-bg);
    border-radius: 14px;
    padding: 1.25rem 1.1rem 0.75rem;
    margin-top: 0.25rem;
}
body.dark .answer-content { background: rgba(124,127,245,0.04); }
.answer-content h1, .answer-content h2 {
    font-size: 1.06rem;
    font-weight: 700;
    color: var(--accent);
    margin: 1.35rem 0 0.65rem;
    border-bottom: 2px solid rgba(91,94,244,0.13);
    padding-bottom: 0.4rem;
}
body.dark .answer-content h1, body.dark .answer-content h2 { border-bottom-color: rgba(124,127,245,0.2); }
.answer-content h3 { font-size: 0.97rem; font-weight: 700; color: var(--text); margin: 1.1rem 0 0.5rem; }
.answer-content p { margin-bottom: 0.95rem; text-align: justify; hyphens: auto; }
.answer-content ul, .answer-content ol { padding-left: 1.6rem; margin-bottom: 0.95rem; }
.answer-content li { margin-bottom: 0.5rem; }
.answer-content strong { color: var(--accent); font-weight: 700; }
body.dark .answer-content strong { color: var(--accent-2); }
.answer-content hr { border: none; border-top: 1px solid rgba(91,94,244,0.12); margin: 1.1rem 0; }
/* ─── Premium Table ─── */
.table-wrapper {
    overflow: visible;
    border-radius: 16px;
    margin: 1.25rem 0;
    background: var(--surface);
    clip-path: inset(0 round 16px);
    box-shadow:
        0 0 0 1px rgba(91,94,244,0.14),
        0 4px 20px rgba(91,94,244,0.08),
        -4px -4px 8px var(--shadow-light),
        4px 4px 8px var(--shadow-dark);
}
body.dark .table-wrapper {
    box-shadow:
        0 0 0 1px rgba(124,127,245,0.2),
        0 4px 20px rgba(0,0,0,0.3),
        -3px -3px 6px var(--shadow-light),
        3px 3px 6px var(--shadow-dark);
}
/* Inner scroll container */
.table-scroll-inner {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    border-radius: inherit;
    scrollbar-width: thin;
    scrollbar-color: var(--accent) transparent;
}
.table-scroll-inner::-webkit-scrollbar { height: 4px; }
.table-scroll-inner::-webkit-scrollbar-thumb {
    background: var(--accent);
    border-radius: 99px;
}

.answer-content table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.88rem;
    border-radius: 16px;
    overflow: hidden;
}

/* Header row */
.answer-content thead tr {
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%);
}
.answer-content th {
    padding: 0.75rem 1rem;
    text-align: left;
    /* ✅ FIX: explicit background on th so light mode shows gradient header */
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%);
    color: #fff;
    font-weight: 700;
    font-size: 0.85rem;
    letter-spacing: 0.03em;
    white-space: nowrap;
    /* Column separator */
    border-right: 1px solid rgba(255,255,255,0.18);
    position: relative;
}
.answer-content th:last-child { border-right: none; }
/* Subtle top-left radius on first header */
.answer-content th:first-child { border-radius: 0; }

/* Body rows */
.answer-content td {
    padding: 0.62rem 1rem;
    border-bottom: 1px solid rgba(91,94,244,0.08);
    border-right: 1px solid rgba(91,94,244,0.08);
    color: var(--text);
    vertical-align: middle;
    transition: background 0.18s ease;
    line-height: 1.5;
}
.answer-content td:last-child { border-right: none; }
.answer-content tr:last-child td { border-bottom: none; }

/* Zebra stripe */
.answer-content tbody tr:nth-child(even) td {
    background: rgba(91,94,244,0.04);
}
body.dark .answer-content tbody tr:nth-child(even) td {
    background: rgba(124,127,245,0.06);
}

/* Row hover */
@media (hover: hover) {
    .answer-content tbody tr:hover td {
        background: rgba(91,94,244,0.09) !important;
        color: var(--accent);
    }
}

/* Dark mode table borders */
body.dark .answer-content td,
body.dark .answer-content th {
    border-color: rgba(124,127,245,0.12);
}
body.dark .answer-content th {
    border-right-color: rgba(255,255,255,0.14);
    /* Dark mode: keep the gradient but slightly adjusted for dark bg context */
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%);
    color: #fff;
}

/* ════════════════════════════
   MCQ — Premium Card & Options
   ════════════════════════════ */
.mcq-wrap { display: flex; flex-direction: column; gap: 1rem; }

.mcq-card {
    background: var(--surface);
    border-radius: 18px;
    padding: 1.1rem 1.25rem;
    box-shadow: -5px -5px 10px var(--shadow-light), 5px 5px 10px var(--shadow-dark);
    transition: box-shadow 0.3s ease, transform 0.28s ease, border-color 0.28s ease;
    border: 1.5px solid transparent;
}
@media (hover: hover) {
    .mcq-card:hover {
        box-shadow: -7px -7px 14px var(--shadow-light), 7px 7px 14px var(--shadow-dark);
        border-color: rgba(91,94,244,0.13);
        transform: translateY(-2px);
    }
    .mcq-card:hover .mcq-badge { transform: rotate(-5deg) scale(1.12); box-shadow: 0 5px 14px rgba(99,102,241,0.52); }
}
/* answered states */
.mcq-card.c-ok {
    border-color: rgba(16,185,129,0.28);
    box-shadow: -4px -4px 10px var(--shadow-light), 4px 4px 10px var(--shadow-dark),
                0 0 0 1px rgba(16,185,129,0.14), 0 8px 24px rgba(16,185,129,0.1);
}
.mcq-card.c-no {
    border-color: rgba(244,63,94,0.22);
    box-shadow: -4px -4px 10px var(--shadow-light), 4px 4px 10px var(--shadow-dark),
                0 0 0 1px rgba(244,63,94,0.12), 0 8px 24px rgba(244,63,94,0.08);
}
body.dark .mcq-card.c-ok { border-color: rgba(16,185,129,0.36); box-shadow: -3px -3px 8px var(--shadow-light), 3px 3px 8px var(--shadow-dark), 0 0 0 1px rgba(16,185,129,0.22), 0 8px 24px rgba(16,185,129,0.13); }
body.dark .mcq-card.c-no { border-color: rgba(244,63,94,0.3); box-shadow: -3px -3px 8px var(--shadow-light), 3px 3px 8px var(--shadow-dark), 0 0 0 1px rgba(244,63,94,0.16), 0 8px 24px rgba(244,63,94,0.1); }

/* Question header row (badge + text) */
.mcq-q-header { display: flex; align-items: flex-start; gap: 0.75rem; margin-bottom: 0.9rem; }
.mcq-q-header .mcq-badge { flex-shrink: 0; margin-top: 0.08rem; }

/* Badge state classes */
.mcq-badge {
    transition: transform 0.28s cubic-bezier(0.34,1.56,0.64,1),
                box-shadow 0.28s ease, background 0.28s ease !important;
}
.mcq-badge.hov      { transform: rotate(-5deg) scale(1.1) !important; box-shadow: 0 4px 12px rgba(99,102,241,0.5) !important; }
.mcq-badge.ans-ok   { background: linear-gradient(135deg,#10b981,#059669) !important; box-shadow: 0 4px 12px rgba(16,185,129,0.45) !important; transform: rotate(-5deg) scale(1.12) !important; }
.mcq-badge.ans-no   { background: linear-gradient(135deg,#f43f5e,#e11d48) !important; box-shadow: 0 4px 12px rgba(244,63,94,0.45) !important; transform: rotate(-5deg) scale(1.12) !important; }
.mcq-badge.pulse    { animation: badgePulse 0.45s cubic-bezier(0.34,1.56,0.64,1) !important; }

.mcq-q-text { font-weight: 700; font-size: 0.95rem; margin-bottom: 0; color: var(--text); line-height: 1.6; flex: 1; }
.mcq-q-text.en { font-family: 'Inter', sans-serif; line-height: 1.55; }

/* Options */
.mcq-options { display: flex; flex-direction: column; gap: 0.6rem; }
.mcq-option {
    display: flex;
    align-items: center;
    gap: 0.7rem;
    padding: 0.68rem 1rem;
    border-radius: 13px;
    background: var(--bg2);
    cursor: pointer;
    font-size: 0.88rem;
    color: var(--text);
    transition: all 0.35s cubic-bezier(0.4,0,0.2,1);
    border: 2px solid transparent;
    box-shadow: inset 2px 2px 4px var(--shadow-dark), inset -2px -2px 4px var(--shadow-light);
    -webkit-tap-highlight-color: transparent;
    user-select: none;
}
@media (hover: hover) and (pointer: fine) {
    .mcq-option:hover {
        border-color: var(--accent);
        color: var(--accent);
        background: rgba(99,102,241,0.07);
        transform: translateX(4px);
        box-shadow: inset 2px 2px 4px var(--shadow-dark), inset -2px -2px 4px var(--shadow-light),
                    -4px 0 0 0 var(--accent);
    }
    .mcq-option:hover .opt-letter { background: var(--accent); color: #fff; transform: scale(1.08); }
}
.mcq-option:active { transform: scale(0.975); }
.mcq-option.correct { background: rgba(16,185,129,0.12); border-color: var(--accent-4); color: #059669; box-shadow: 0 0 0 2px rgba(16,185,129,0.2); transform: none; }
.mcq-option.incorrect { background: rgba(244,63,94,0.1); border-color: var(--accent-rose); color: var(--accent-rose); box-shadow: 0 0 0 2px rgba(244,63,94,0.2); transform: none; }

/* Option letter badge */
.opt-letter {
    width: 28px; height: 28px;
    border-radius: 9px;
    background: var(--surface);
    display: flex; align-items: center; justify-content: center;
    font-size: 0.75rem; font-weight: 700;
    flex-shrink: 0; color: var(--accent);
    box-shadow: -2px -2px 4px var(--shadow-light), 2px 2px 4px var(--shadow-dark);
    transition: background 0.2s ease, color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
}
/* English letter: Inter font */
.opt-letter.en { font-family: 'Inter', sans-serif; font-size: 0.78rem; border-radius: 8px; }
.mcq-option.correct .opt-letter { background: var(--accent-4); color: #fff; box-shadow: none; }
.mcq-option.incorrect .opt-letter { background: var(--accent-rose); color: #fff; box-shadow: none; }

.option-icon {
    margin-left: auto; font-size: 1rem; flex-shrink: 0;
    transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1);
}
.mcq-option.correct .option-icon,
.mcq-option.incorrect .option-icon { transform: scale(1.25); }

/* ---- BOOKMARK BUTTON ---- */
.bookmark-btn {
    background: none;
    border: none;
    cursor: pointer;
    color: var(--text-3);
    padding: 0.25rem;
    border-radius: 8px;
    transition: all var(--transition);
    flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
}
.bookmark-btn:hover { color: var(--accent-warm); }
.bookmark-btn.bookmarked { color: var(--accent-warm); }

/* ---- BOOKMARK PAGE ---- */
#bookmarks-section .empty-state {
    text-align: center;
    padding: 3rem 1rem;
    color: var(--text-3);
}
#bookmarks-section .empty-state svg { margin: 0 auto 1rem; opacity: 0.4; display: block; }

/* ---- SYLLABUS (see v4.0 section below for redesigned styles) ---- */
#syllabus-section { padding: 0 1rem 2rem; max-width: 1200px; margin: 0 auto; width: 100%; }


/* ---- THEME TOGGLE ---- */
.theme-toggle-wrap { display: flex; align-items: center; }
.toggle-track {
    width: 54px; height: 30px;
    border-radius: 99px;
    background: var(--surface);
    box-shadow:
        inset 3px 3px 7px var(--shadow-dark),
        inset -3px -3px 7px var(--shadow-light);
    position: relative;
    cursor: pointer;
    transition: box-shadow 0.3s ease;
    border: 1.5px solid transparent;
}
@media (hover: hover) {
    .toggle-track:hover {
        box-shadow:
            inset 4px 4px 8px var(--shadow-dark),
            inset -4px -4px 8px var(--shadow-light),
            0 0 0 2px rgba(99,102,241,0.18);
    }
}
.toggle-thumb {
    position: absolute;
    top: 4px; left: 4px;
    width: 20px; height: 20px;
    border-radius: 50%;
    background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
    box-shadow:
        0 2px 8px rgba(245,158,11,0.55),
        0 1px 3px rgba(0,0,0,0.15),
        inset 0 1px 0 rgba(255,255,255,0.3);
    transition: left 0.3s cubic-bezier(0.34,1.56,0.64,1),
                background 0.3s ease,
                box-shadow 0.3s ease;
    display: flex; align-items: center; justify-content: center;
}
.toggle-track.dark-mode .toggle-thumb {
    left: 28px;
    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
    box-shadow:
        0 2px 10px rgba(99,102,241,0.6),
        0 1px 3px rgba(0,0,0,0.2),
        inset 0 1px 0 rgba(255,255,255,0.2);
}
#theme-toggle-input { display: none; }

/* ---- QUOTE ---- */
.quote-section {
    text-align: center;
    padding: 1.5rem 1rem;
}
.quote-text {
    font-size: 0.85rem;
    font-style: italic;
    color: var(--text-3);
    letter-spacing: 0.02em;
}

/* ---- INTRO SECTION ---- */
#intro-section { padding: 0 1rem; max-width: 1200px; margin: 0 auto; width: 100%; }
#intro-section .welcome-text { 
    font-family: 'Kalpurush', 'Inter', sans-serif;
    font-size: clamp(1.3rem, 4vw, 2rem);
    font-weight: 700;
    color: var(--text);
    margin-bottom: 0.5rem;
}
#intro-section .welcome-sub { 
    color: var(--text-2);
    font-size: clamp(0.85rem, 2.5vw, 1rem);
    margin-bottom: 2rem;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
}

/* ---- PROGRESS TRACKER (new feature) ---- */
#progress-section { padding: 0 1rem; max-width: 1200px; margin: 0 auto 1.5rem; width: 100%; }
.progress-card {
    background: var(--surface);
    border-radius: 18px;
    padding: 1.25rem 1.5rem;
    box-shadow: -6px -6px 12px var(--shadow-light), 6px 6px 12px var(--shadow-dark);
}
.progress-card h3 { font-size: 1rem; font-weight: 700; margin-bottom: 1rem; color: var(--text); display: flex; align-items: center; gap: 0.5rem; }
.progress-item { margin-bottom: 0.85rem; }
.progress-item .pi-label { font-size: 0.8rem; color: var(--text-2); margin-bottom: 0.3rem; display: flex; justify-content: space-between; }
.progress-item .pi-bar { height: 8px; background: var(--bg2); border-radius: 99px; overflow: hidden; }
.progress-item .pi-fill { height: 100%; border-radius: 99px; background: linear-gradient(90deg, var(--accent), var(--accent-2)); transition: width 1s ease; }

/* ---- LOADING ---- */
.loading-skeleton {
    background: linear-gradient(90deg, var(--bg2) 25%, var(--surface-2) 50%, var(--bg2) 75%);
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
    border-radius: 10px;
}
@keyframes shimmer { 0%{background-position:200% 0} 100%{background-position:-200% 0} }

/* ---- TOAST NOTIFICATION ---- */
#toast-container {
    position: fixed;
    bottom: 1.5rem;
    right: 1.5rem;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    pointer-events: none;
}
.toast {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    padding: 0.75rem 1.1rem;
    border-radius: 14px;
    background: var(--surface-2);
    color: var(--text);
    font-size: 0.85rem;
    font-weight: 600;
    box-shadow: 0 10px 30px rgba(0,0,0,0.18), 0 0 0 1px rgba(91,94,244,0.18);
    animation: toastIn 0.35s cubic-bezier(0.34,1.56,0.64,1) forwards;
    pointer-events: auto;
}
body.dark .toast {
    background: var(--surface-2);
    box-shadow: 0 10px 30px rgba(0,0,0,0.5), 0 0 0 1px rgba(124,127,245,0.2);
}
.toast.out { animation: toastOut 0.3s ease forwards; }
.toast .t-icon { font-size: 1.1rem; }
@keyframes toastIn { from{transform:translateX(100px);opacity:0} to{transform:translateX(0);opacity:1} }
@keyframes toastOut { from{transform:translateX(0);opacity:1} to{transform:translateX(100px);opacity:0} }

/* Open accordion badge pulse */
.q-accordion.is-open .q-num-badge {
    animation: badgePulse 0.4s cubic-bezier(0.34,1.56,0.64,1);
}
@keyframes badgePulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.2) rotate(-8deg); }
    100% { transform: rotate(-5deg) scale(1.05); }
}

/* ---- FOOTER ---- */
footer {
    margin-top: auto;
    text-align: center;
    padding: 1.5rem 1rem;
    font-size: 0.78rem;
    color: var(--text-3);
    border-top: 1px solid rgba(0,0,0,0.06);
}
body.dark footer { border-top-color: rgba(255,255,255,0.04); }
footer span.brand { font-weight: 700; color: var(--accent); }

/* ---- ANIMATIONS ---- */
.fade-in { animation: fadeIn 0.5s ease both; }
@keyframes fadeIn { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }

.reveal-on-scroll {
    opacity: 0;
    transform: translateY(24px);
    transition: opacity 0.55s cubic-bezier(0.4,0,0.2,1), transform 0.55s cubic-bezier(0.4,0,0.2,1);
}
.reveal-on-scroll.is-visible { opacity: 1; transform: translateY(0); }

/* Stagger for accordion items */
.q-accordion.reveal-on-scroll:nth-child(2) { transition-delay: 0.05s; }
.q-accordion.reveal-on-scroll:nth-child(3) { transition-delay: 0.1s; }
.q-accordion.reveal-on-scroll:nth-child(4) { transition-delay: 0.15s; }
.q-accordion.reveal-on-scroll:nth-child(5) { transition-delay: 0.2s; }
.q-accordion.reveal-on-scroll:nth-child(n+6) { transition-delay: 0.25s; }

/* ---- FLOATING ACTION BUTTON ---- */
#fab {
    position: fixed;
    bottom: 1.5rem;
    left: 1.5rem;
    z-index: 500;
    width: 52px; height: 52px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color: #fff;
    border: none;
    cursor: pointer;
    box-shadow: 0 8px 24px rgba(91,94,244,0.4), 0 0 0 4px rgba(91,94,244,0.1);
    display: flex; align-items: center; justify-content: center;
    font-size: 1.2rem;

    /* ── Smart FAB: opacity+scale দিয়ে show/hide, display:none বাদ ── */
    opacity: 0;
    transform: scale(0.6) translateY(12px);
    pointer-events: none;
    transition: opacity 0.3s cubic-bezier(0.4,0,0.2,1),
                transform 0.35s cubic-bezier(0.34,1.56,0.64,1),
                box-shadow 0.25s ease,
                width 0.3s ease,
                height 0.3s ease,
                background 0.25s ease;
}

/* ── দৃশ্যমান অবস্থা (scroll up / থামলে) ── */
#fab.fab-visible {
    opacity: 1;
    transform: scale(1) translateY(0);
    pointer-events: auto;
}

/* ── Peek অবস্থা: নিচে scroll করলে ছোট dot হয় ──
   content পড়ার সময় একটুও distract করে না,
   কিন্তু FAB সম্পূর্ণ হারিয়ে যায় না            */
#fab.fab-peek {
    opacity: 0.35;
    width: 10px;
    height: 10px;
    transform: scale(1) translateY(0);
    pointer-events: none;
    box-shadow: 0 2px 8px rgba(91,94,244,0.4);
    /* icon লুকানো */
    overflow: hidden;
}
#fab.fab-peek svg { opacity: 0; }

#fab:hover {
    transform: scale(1.12) translateY(-3px);
    box-shadow: 0 14px 36px rgba(91,94,244,0.55), 0 0 0 6px rgba(91,94,244,0.15);
}
#fab:active { transform: scale(0.96); }

/* ── Desktop: peek behavior বাদ, সরাসরি visible/hidden ── */
@media (min-width: 768px) {
    #fab.fab-peek {
        width: 52px;
        height: 52px;
        opacity: 0;
        pointer-events: none;
    }
    #fab.fab-peek svg { opacity: 1; }
}

/* ---- PAGE SCROLL PROGRESS BAR ---- */
#scroll-progress-bar {
    position: fixed;
    top: 0; left: 0;
    height: 3px;
    width: 0%;
    background: linear-gradient(90deg, var(--accent), var(--accent-3), var(--accent-2));
    z-index: 9999;
    transition: width 0.1s linear;
    border-radius: 0 2px 2px 0;
    box-shadow: 0 0 8px rgba(91,94,244,0.6);
}

/* ---- STUDY TIMER ---- */
/* ======================================================
   DYNAMIC NOW-BAR STYLE TIMER / SCORE PILL
   ====================================================== */
#study-timer {
    position: fixed;
    bottom: 1.5rem;
    right: 1.5rem;
    z-index: 500;
    background: var(--surface);
    border-radius: 50px;
    padding: 0.55rem 1.1rem;
    box-shadow:
        -5px -5px 10px var(--shadow-light),
        5px 5px 10px var(--shadow-dark),
        0 0 0 1.5px rgba(99,102,241,0.12),
        0 8px 28px rgba(91,94,244,0.08);
    display: flex;
    align-items: center;
    gap: 0.55rem;
    font-family: 'Inter', monospace;
    font-size: 0.82rem;
    font-weight: 700;
    color: var(--text-2);
    cursor: pointer;
    transition:
        all 0.45s cubic-bezier(0.34, 1.56, 0.64, 1),
        width 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    user-select: none;
    overflow: hidden;
    white-space: nowrap;
    min-width: 80px;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    -webkit-tap-highlight-color: transparent;
    touch-action: pan-y;
}
#study-timer:hover {
    color: var(--accent);
    box-shadow:
        -6px -6px 12px var(--shadow-light),
        6px 6px 12px var(--shadow-dark),
        0 0 0 2px rgba(99,102,241,0.22),
        0 12px 36px rgba(91,94,244,0.14);
    transform: translateY(-2px) scale(1.02);
}
#study-timer:active {
    transform: scale(0.96);
}

/* Timer dot */
#study-timer .timer-dot {
    width: 7px; height: 7px;
    border-radius: 50%;
    background: var(--accent-4);
    box-shadow: 0 0 6px rgba(16,185,129,0.8);
    animation: timerPulse 2s ease-in-out infinite;
    flex-shrink: 0;
    transition: all 0.4s ease;
}
#study-timer.paused .timer-dot {
    background: var(--accent-warm);
    box-shadow: 0 0 6px rgba(245,158,11,0.8);
    animation: none;
}
@keyframes timerPulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.5); opacity: 0.7; }
}

/* Timer panels - slide transition */
#timer-panel, #score-panel {
    display: flex;
    align-items: center;
    gap: 0.45rem;
    transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    flex-shrink: 0;
}

/* Score panel hidden by default */
#score-panel {
    display: none;
    gap: 0.5rem;
}

/* When timer shows score mode */
#study-timer.show-score #timer-panel {
    display: none;
}
#study-timer.show-score #score-panel {
    display: flex;
}
#study-timer.show-score .timer-dot {
    background: var(--accent);
    box-shadow: 0 0 8px rgba(91,94,244,0.7);
    animation: timerPulse 1.5s ease-in-out infinite;
}

/* Score pill content */
.score-pill-score {
    font-size: 1rem;
    font-weight: 800;
    color: var(--accent-4);
    line-height: 1;
    min-width: 14px;
    text-align: center;
    transition: all 0.3s ease;
}
.score-pill-sep {
    color: var(--text-3);
    font-weight: 400;
    font-size: 0.8rem;
}
.score-pill-total {
    font-size: 0.78rem;
    font-weight: 700;
    color: var(--text-2);
}
.score-pill-label {
    font-size: 0.68rem;
    font-weight: 600;
    color: var(--text-3);
    letter-spacing: 0.04em;
    text-transform: uppercase;
}

/* Score updated animation */
@keyframes scoreFlash {
    0% { transform: scale(1); }
    30% { transform: scale(1.4); color: var(--accent-4); }
    100% { transform: scale(1); }
}
.score-pill-score.updated {
    animation: scoreFlash 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* Swipe hint indicator */
.timer-swipe-hint {
    width: 3px; height: 12px;
    border-radius: 99px;
    background: var(--text-3);
    opacity: 0.3;
    transition: opacity 0.3s;
    flex-shrink: 0;
    align-self: center;
}
#study-timer:hover .timer-swipe-hint {
    opacity: 0.6;
}

/* Pill entrance animation */
@keyframes pillEntrance {
    0% { transform: translateY(12px) scale(0.88); opacity: 0; }
    100% { transform: translateY(0) scale(1); opacity: 1; }
}
#study-timer.score-mode-entering {
    animation: pillEntrance 0.42s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

/* ---- KEYBOARD SHORTCUT PANEL ---- */
#shortcut-panel {
    position: fixed;
    inset: 0;
    z-index: 950;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(10px);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.25s ease;
}
#shortcut-panel.open {
    opacity: 1;
    pointer-events: auto;
}
#shortcut-box {
    background: var(--surface);
    border-radius: 24px;
    padding: 1.75rem;
    width: min(440px, 94vw);
    box-shadow: 0 30px 80px rgba(0,0,0,0.3), 0 0 0 1px rgba(99,102,241,0.15);
    transform: translateY(20px) scale(0.96);
    transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1);
}
#shortcut-panel.open #shortcut-box {
    transform: translateY(0) scale(1);
}
.shortcut-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.6rem 0;
    border-bottom: 1px solid rgba(0,0,0,0.06);
    font-size: 0.88rem;
    color: var(--text-2);
}
body.dark .shortcut-row { border-bottom-color: rgba(255,255,255,0.05); }
.shortcut-row:last-child { border-bottom: none; }
.shortcut-row .sk-label { font-family: 'Kalpurush', sans-serif; }
.shortcut-row .sk-keys { display: flex; gap: 0.3rem; }
kbd {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.2rem 0.5rem;
    border-radius: 6px;
    background: var(--bg2);
    box-shadow: 0 2px 0 var(--shadow-dark);
    font-family: 'Inter', monospace;
    font-size: 0.75rem;
    font-weight: 700;
    color: var(--accent);
    border: 1px solid rgba(99,102,241,0.2);
}

/* ---- READING PROGRESS CHIP (per subject) ---- */
.read-progress-wrap {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
    padding: 0.6rem 1rem;
    background: var(--surface);
    border-radius: 12px;
    box-shadow: -3px -3px 6px var(--shadow-light), 3px 3px 6px var(--shadow-dark);
}
.read-progress-bar-track {
    flex: 1;
    height: 6px;
    background: var(--bg2);
    border-radius: 99px;
    overflow: hidden;
}
.read-progress-bar-fill {
    height: 100%;
    border-radius: 99px;
    background: linear-gradient(90deg, var(--accent-4), #34d399);
    transition: width 0.6s cubic-bezier(0.4,0,0.2,1);
    width: 0%;
}
.read-progress-label {
    font-size: 0.72rem;
    font-weight: 700;
    color: var(--text-3);
    white-space: nowrap;
}

/* MCQ card state: handled by .c-ok / .c-no classes */
.mcq-card[data-answered] { border-color: inherit; }

/* ---- FEATURE CARDS already defined above — upgraded ---- */
/* (kept here for reference compatibility) */

/* ---- TOAST upgrade ---- */
.toast {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    padding: 0.8rem 1.2rem;
    border-radius: 16px;
    background: var(--surface-2);
    color: var(--text);
    font-size: 0.85rem;
    font-weight: 600;
    box-shadow: 0 12px 36px rgba(0,0,0,0.18), 0 0 0 1px rgba(99,102,241,0.18), inset 0 1px 0 rgba(255,255,255,0.1);
    animation: toastIn 0.4s cubic-bezier(0.34,1.56,0.64,1) forwards;
    pointer-events: auto;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    border-left: 3px solid var(--accent);
}
.toast.success { border-left-color: var(--accent-4); }
.toast.warning { border-left-color: var(--accent-warm); }
.toast.error { border-left-color: var(--accent-rose); }
.toast.out { animation: toastOut 0.3s ease forwards; }
.toast .t-icon { font-size: 1.1rem; }
@keyframes toastIn { from{transform:translateX(110px) scale(0.9);opacity:0} to{transform:translateX(0) scale(1);opacity:1} }
@keyframes toastOut { from{transform:translateX(0) scale(1);opacity:1} to{transform:translateX(110px) scale(0.9);opacity:0} }

/* ---- PRINT BUTTON in answer ---- */
.answer-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding-top: 1rem;
    margin-top: 1rem;
    border-top: 1px solid rgba(99,102,241,0.1);
    opacity: 0;
    animation: fadeInShare 0.4s 0.3s ease forwards;
    flex-wrap: wrap;
}
.action-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.35rem 0.9rem;
    border-radius: 99px;
    border: 1.5px solid rgba(99,102,241,0.2);
    background: rgba(99,102,241,0.05);
    color: var(--text-3);
    font-family: 'Kalpurush', 'Inter', sans-serif;
    font-size: 0.78rem;
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition);
}
.action-btn:hover {
    border-color: var(--accent);
    color: var(--accent);
    background: rgba(99,102,241,0.1);
    transform: translateY(-1px);
}
.action-btn.read-done {
    border-color: var(--accent-4);
    color: var(--accent-4);
    background: rgba(16,185,129,0.08);
}
.action-btn.read-done:hover {
    border-color: var(--accent-4);
    color: var(--accent-4);
    background: rgba(16,185,129,0.15);
}

/* ---- STAT ITEM upgrade ---- */
.stat-item {
    background: var(--surface);
    border-radius: 18px;
    padding: 1.1rem 1.2rem;
    text-align: center;
    box-shadow: -6px -6px 12px var(--shadow-light), 6px 6px 12px var(--shadow-dark);
    transition: all var(--transition);
    border: 1px solid transparent;
    cursor: default;
}
.stat-item:hover { 
    transform: translateY(-4px); 
    border-color: rgba(99,102,241,0.12);
    box-shadow: -7px -7px 14px var(--shadow-light), 7px 7px 14px var(--shadow-dark), 0 10px 28px rgba(99,102,241,0.12);
}
.stat-item .s-num {
    font-family: 'Inter', sans-serif;
    font-size: 2rem;
    font-weight: 700;
    line-height: 1;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
.stat-item .s-label { font-size: 0.75rem; color: var(--text-2); margin-top: 0.35rem; font-weight: 600; }
.stat-item .s-icon { font-size: 1.4rem; margin-bottom: 0.25rem; }

/* Count-up animation */
@keyframes countUp {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}
.s-num { animation: countUp 0.6s ease both; }

/* ---- HEADER upgrade ---- */
header {
    position: relative;
    z-index: 10;
    padding: 2rem 1rem 1rem;
}
header h1 {
    font-family: 'Kalpurush', 'Inter', sans-serif;
    font-size: clamp(1.7rem, 5vw, 2.9rem);
    font-weight: 700;
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 50%, var(--accent-3) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1.4;
    text-align: center;
    letter-spacing: -0.01em;
}
.header-badge {
    display: inline-block;
    font-size: 0.68rem;
    font-weight: 700;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    padding: 0.3rem 1rem;
    border-radius: 99px;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color: #fff;
    margin-bottom: 0.75rem;
    box-shadow: 0 4px 14px rgba(99,102,241,0.4);
    animation: badgePop 0.6s cubic-bezier(0.34,1.56,0.64,1) both;
}
@keyframes badgePop {
    from { transform: scale(0.7); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

/* ---- SHORTCUT HINT (bottom of page) ---- */
.shortcut-hint {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    font-size: 0.72rem;
    color: var(--text-3);
    cursor: pointer;
    transition: color var(--transition);
}
.shortcut-hint:hover { color: var(--accent); }
.shortcut-hint kbd { font-size: 0.65rem; }

/* ---- MODAL ---- */
#modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.5);
    backdrop-filter: blur(8px);
    z-index: 900;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--transition);
}
#modal-overlay.open { opacity: 1; pointer-events: auto; }
#modal-box {
    background: var(--surface);
    border-radius: 24px 24px 0 0;
    padding: 1.5rem;
    width: 100%;
    max-width: 520px;
    max-height: 85vh;
    overflow-y: auto;
    box-shadow: 0 -20px 60px rgba(0,0,0,0.2);
    transform: translateY(100%);
    transition: transform 0.4s cubic-bezier(0.34,1.56,0.64,1);
}
#modal-overlay.open #modal-box { transform: translateY(0); }
.modal-handle {
    width: 40px; height: 4px;
    background: var(--text-3);
    border-radius: 99px;
    margin: 0 auto 1.25rem;
    opacity: 0.4;
}

/* ---- MOBILE RESPONSIVE ---- */
@media (max-width: 640px) {
    #stats-bar { grid-template-columns: repeat(2, 1fr); }
    #top-sticky-bar .inner { gap: 0.45rem; }
    .search-wrap { min-width: 130px; }
    .neu-btn { padding: 0.45rem 0.85rem; font-size: 0.8rem; }
    .q-header { font-size: 0.9rem; padding: 0.9rem 1rem; line-height: 1.55; }
    .q-body.open { padding: 0 1rem 1.25rem; }
    header { padding: 1.5rem 1rem 0.75rem; }
    .answer-content { padding: 1rem 0.85rem 0.75rem; font-size: 0.93rem; line-height: 1.8; }
    .q-accordion { border-radius: 14px; }
    .q-num-badge { width: 26px; height: 26px; font-size: 0.68rem; }
    /* Mobile MCQ */
    .mcq-card { padding: 0.9rem 1rem; border-radius: 15px; }
    .mcq-q-header { gap: 0.6rem; margin-bottom: 0.72rem; }
    .mcq-q-text { font-size: 0.9rem; }
    .mcq-options { gap: 0.5rem; }
    .mcq-option { padding: 0.6rem 0.85rem; font-size: 0.85rem; border-radius: 11px; gap: 0.6rem; }
    .opt-letter { width: 25px; height: 25px; font-size: 0.7rem; border-radius: 7px; }
    .mcq-wrap { gap: 0.85rem; }
    /* Mobile filter */
    .filter-wrap { padding: 0.75rem 1rem; gap: 0.65rem; border-radius: 16px; }
    .filter-group label { font-size: 0.75rem; }
    /* Mobile table */
    .table-wrapper { border-radius: 12px; clip-path: inset(0 round 12px) !important; }
}
/* FIX: খুব ছোট স্ক্রিন (320-375px Android) — top bar দুই লাইনে ভেঙে যায় */
@media (max-width: 380px) {
    .search-wrap { min-width: 90px; }
    #top-sticky-bar .inner { gap: 0.3rem; flex-wrap: nowrap; }
    .neu-btn { padding: 0.4rem 0.6rem; font-size: 0.75rem; }
    /* শুধু icon দেখাও, text লুকাও */
    #home-button span,
    #syllabus-button span { display: none !important; }
    #home-button { padding: 0.4rem 0.6rem; }
}
@media (min-width: 768px) {
    #modal-box { border-radius: 24px; }
    #modal-overlay { align-items: center; }
}

/* ---- NO RESULTS ---- */
.no-results {
    text-align: center;
    padding: 3rem 1rem;
    color: var(--text-3);
}
.no-results .nr-icon { font-size: 3rem; margin-bottom: 0.75rem; }
.no-results p { font-size: 0.9rem; }

/* ---- HORIZONTAL SCROLL PILL NAV ---- */
.pill-scroll-nav {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    padding-bottom: 0.25rem;
    scrollbar-width: none;
    -ms-overflow-style: none;
}
.pill-scroll-nav::-webkit-scrollbar { display: none; }

/* Dark mode fine-tuning */
body.dark .mcq-option { background: var(--bg2); }
body.dark select.neu-select { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%238b9ab8' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E"); }
body.dark .answer-content h2 { border-bottom-color: rgba(124,127,245,0.22); }
body.dark .answer-content strong { color: #c4b5fd; }

/* ---- FONT SIZE SYSTEM ---- */
/* Font size button in top bar */
.font-size-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
    padding: 0.45rem 0.85rem;
    border-radius: 99px;
    border: none;
    background: var(--surface);
    color: var(--text-2);
    font-family: 'Inter', sans-serif;
    font-weight: 700;
    font-size: 0.8rem;
    cursor: pointer;
    box-shadow: -4px -4px 8px var(--shadow-light), 4px 4px 8px var(--shadow-dark);
    transition: all var(--transition);
    white-space: nowrap;
    flex-shrink: 0;
    letter-spacing: 0.02em;
    user-select: none;
}
.font-size-btn:hover {
    color: var(--accent);
    box-shadow: -5px -5px 10px var(--shadow-light), 5px 5px 10px var(--shadow-dark), 0 0 0 2px rgba(99,102,241,0.2);
}
.font-size-btn .fs-indicator {
    font-size: 0.65rem;
    padding: 0.1rem 0.4rem;
    border-radius: 99px;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color: #fff;
    font-weight: 700;
    letter-spacing: 0.05em;
}

/* Font size presets — applied to body */
body.fs-normal .q-header,
body.fs-normal .answer-content,
body.fs-normal .mcq-q-text,
body.fs-normal .mcq-option { font-size: revert; }

body.fs-large .q-header { font-size: 1.07rem; }
body.fs-large .answer-content { font-size: 1.07rem; }
body.fs-large .mcq-q-text { font-size: 1.07rem; }
body.fs-large .mcq-option { font-size: 1rem; }
body.fs-large .answer-content h1,
body.fs-large .answer-content h2 { font-size: 1.18rem; }
body.fs-large .answer-content h3 { font-size: 1.07rem; }

body.fs-xlarge .q-header { font-size: 1.2rem; }
body.fs-xlarge .answer-content { font-size: 1.2rem; }
body.fs-xlarge .mcq-q-text { font-size: 1.2rem; }
body.fs-xlarge .mcq-option { font-size: 1.1rem; }
body.fs-xlarge .answer-content h1,
body.fs-xlarge .answer-content h2 { font-size: 1.32rem; }
body.fs-xlarge .answer-content h3 { font-size: 1.2rem; }

/* ---- CONTEXT MENU (Share) ---- */
#ctx-menu {
    position: fixed;
    z-index: 9000;
    background: var(--surface-2);
    border-radius: 16px;
    padding: 0.5rem;
    box-shadow: 0 20px 60px rgba(0,0,0,0.2), 0 0 0 1px rgba(99,102,241,0.15);
    min-width: 190px;
    opacity: 0;
    pointer-events: none;
    transform: scale(0.94) translateY(-6px);
    transform-origin: top left;
    transition: opacity 0.18s ease, transform 0.18s cubic-bezier(0.34,1.56,0.64,1);
}
#ctx-menu.open {
    opacity: 1;
    pointer-events: auto;
    transform: scale(1) translateY(0);
}
.ctx-item {
    display: flex;
    align-items: center;
    gap: 0.65rem;
    padding: 0.65rem 0.9rem;
    border-radius: 10px;
    cursor: pointer;
    font-size: 0.88rem;
    font-weight: 600;
    color: var(--text);
    font-family: 'Kalpurush', 'Inter', sans-serif;
    transition: background var(--transition), color var(--transition);
    border: none;
    background: none;
    width: 100%;
    text-align: left;
}
.ctx-item:hover { background: rgba(99,102,241,0.1); color: var(--accent); }
.ctx-item svg { flex-shrink: 0; opacity: 0.7; }
.ctx-item:hover svg { opacity: 1; }
.ctx-divider {
    height: 1px;
    background: rgba(0,0,0,0.07);
    margin: 0.3rem 0.5rem;
}
body.dark .ctx-divider { background: rgba(255,255,255,0.07); }
.ctx-label {
    font-size: 0.68rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--text-3);
    font-weight: 700;
    padding: 0.3rem 0.9rem 0.1rem;
}

/* ---- SHARE HINT (legacy - kept for compat) ---- */
.share-hint-row { display: none; }

/* ---- KEYBOARD SHORTCUT BUTTON & HINT — desktop only ---- */
.shortcut-desktop-only {
    display: none !important;
}
@media (hover: hover) and (pointer: fine) {
    .shortcut-desktop-only {
        display: inline-flex !important;
    }
    p.shortcut-desktop-only {
        display: block !important;
    }
}

/* ---- MCQ CONTROLS (fix hidden+flex conflict) ---- */
#mcq-controls {
    display: none;
    flex-direction: row;
    gap: 0.5rem;
    align-items: center;
    flex-wrap: wrap;
}
#mcq-controls.hidden { display: none !important; }

/* ---- REVEAL ALL BTN ---- */
.reveal-all-btn {
    background: linear-gradient(135deg, var(--accent-4), #059669) !important;
    color: #fff !important;
    box-shadow: 0 4px 14px rgba(16,185,129,0.35) !important;
    border: none;
}
.reveal-all-btn:hover {
    box-shadow: 0 6px 20px rgba(16,185,129,0.5) !important;
    transform: translateY(-2px) !important;
    color: #fff !important;
}

/* ---- SUBJECT PICKER MODAL ---- */
.subject-picker-overlay {
    position: fixed;
    inset: 0;
    z-index: 950;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    background: rgba(0, 0, 0, 0.45);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    opacity: 0;
    transition: opacity 0.3s ease;
    padding-bottom: env(safe-area-inset-bottom, 0);
}
.subject-picker-overlay.open { opacity: 1; }
.subject-picker-overlay.hidden { display: none !important; }

#subject-picker-box {
    background: var(--surface);
    border-radius: 28px 28px 0 0;
    width: 100%;
    max-width: 560px;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 -20px 60px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(91,94,244,0.1);
    transform: translateY(100%);
    transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    overscroll-behavior: contain;
}
.subject-picker-overlay.open #subject-picker-box {
    transform: translateY(0);
}
@media (min-width: 640px) {
    .subject-picker-overlay { align-items: center; padding: 1rem; }
    #subject-picker-box { border-radius: 24px; max-height: 70vh; }
}

.subject-picker-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    padding: 1.25rem 1.5rem 0.75rem;
    border-bottom: 1px solid rgba(0,0,0,0.07);
    position: sticky;
    top: 0;
    background: var(--surface);
    z-index: 2;
}
body.dark .subject-picker-header { border-bottom-color: rgba(255,255,255,0.06); }
.subject-picker-header h3 {
    font-size: 1.05rem;
    font-weight: 700;
    color: var(--text);
}

.picker-close-btn {
    width: 32px; height: 32px;
    border-radius: 50%;
    border: none;
    background: var(--bg2);
    color: var(--text-2);
    cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    box-shadow: -2px -2px 4px var(--shadow-light), 2px 2px 4px var(--shadow-dark);
    transition: all var(--transition);
    flex-shrink: 0;
}
.picker-close-btn:hover { color: var(--accent-rose); background: rgba(244,63,94,0.1); }

.subject-picker-list {
    padding: 0.75rem 1rem 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.subject-picker-btn {
    display: flex;
    align-items: center;
    gap: 0.9rem;
    padding: 0.9rem 1.1rem;
    border-radius: 16px;
    border: 1.5px solid transparent;
    background: var(--bg2);
    cursor: pointer;
    text-align: left;
    width: 100%;
    font-family: 'Kalpurush', 'Inter', sans-serif;
    color: var(--text);
    transition: all var(--transition);
    box-shadow: inset 2px 2px 4px var(--shadow-dark), inset -2px -2px 4px var(--shadow-light);
    -webkit-tap-highlight-color: transparent;
}
.subject-picker-btn:hover {
    border-color: var(--accent);
    background: rgba(91,94,244,0.06);
    transform: translateX(4px);
    box-shadow: -4px -4px 8px var(--shadow-light), 4px 4px 8px var(--shadow-dark), 0 4px 12px rgba(91,94,244,0.12);
}
.subject-picker-btn:active { transform: scale(0.98); }

.picker-icon {
    font-size: 1.6rem;
    width: 44px; height: 44px;
    display: flex; align-items: center; justify-content: center;
    background: var(--surface);
    border-radius: 12px;
    box-shadow: -3px -3px 6px var(--shadow-light), 3px 3px 6px var(--shadow-dark);
    flex-shrink: 0;
}

.picker-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.1rem;
}
.picker-name {
    font-weight: 700;
    font-size: 0.95rem;
    color: var(--text);
}
.picker-meta {
    font-size: 0.72rem;
    color: var(--text-3);
    font-weight: 600;
}
.picker-chevron {
    color: var(--text-3);
    flex-shrink: 0;
    transition: transform var(--transition), color var(--transition);
}
.subject-picker-btn:hover .picker-chevron {
    color: var(--accent);
    transform: translateX(3px);
}


/* ════════════════════════════════════════════
   ADDITIONAL FIXES & NEW SECTIONS
════════════════════════════════════════════ */

/* ---- BOOKMARKS SECTION ---- */
.bookmarks-section-wrap {
    padding: 0 1rem 2rem;
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
}
.bookmarks-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.25rem;
    gap: 1rem;
    flex-wrap: wrap;
}
.bookmarks-title {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--text);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}
.clear-bookmarks-btn {
    color: var(--accent-rose) !important;
}
.clear-bookmarks-btn:hover {
    background: rgba(244,63,94,0.08) !important;
    border-color: var(--accent-rose) !important;
}

/* ---- SYLLABUS SECTION ---- */
.syllabus-section-wrap {
    padding: 0 1rem 2rem;
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
}

/* ---- PROGRESS SECTION ---- */
#progress-section {
    padding: 0 1rem;
    max-width: 1200px;
    margin: 0 auto 1.5rem;
    width: 100%;
}

/* ---- FEATURE CARD LINKED (clickable home cards) ---- */
.feature-card-linked {
    cursor: pointer;
    position: relative;
    overflow: hidden;
    border: 1.5px solid transparent;
    transition: all var(--transition);
}
.feature-card-linked:hover {
    transform: translateY(-6px);
    box-shadow: -8px -8px 18px var(--shadow-light), 8px 8px 18px var(--shadow-dark),
                0 16px 40px rgba(91,94,244,0.16);
    border-color: rgba(91,94,244,0.2);
}
.feature-card-linked:active {
    transform: translateY(-2px) scale(0.98);
}
.feature-card-arrow {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 28px; height: 28px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color: #fff;
    margin: 0.6rem auto 0;
    box-shadow: 0 3px 10px rgba(91,94,244,0.35);
    transition: all var(--transition);
    opacity: 0.75;
}
.feature-card-linked:hover .feature-card-arrow {
    opacity: 1;
    transform: translateX(4px);
    box-shadow: 0 5px 16px rgba(91,94,244,0.5);
}
.feature-card-linked:hover .icon-container {
    transform: scale(1.1) rotate(-4deg);
}

/* ---- REVEAL ALL BUTTON (premium green) ---- */
.reveal-all-btn {
    background: linear-gradient(135deg, #10b981, #059669) !important;
    color: #fff !important;
    box-shadow: 0 4px 14px rgba(16,185,129,0.4) !important;
}
.reveal-all-btn:hover {
    box-shadow: 0 6px 20px rgba(16,185,129,0.55) !important;
    transform: translateY(-2px) !important;
    color: #fff !important;
}
.reveal-all-btn::after { display: none !important; }

/* ---- KEYBOARD SHORTCUT BUTTON / HINT — desktop only ---- */
.shortcut-desktop-only {
    display: none !important;
}
@media (hover: hover) and (pointer: fine) {
    .shortcut-desktop-only {
        display: inline-flex !important;
    }
    p.shortcut-desktop-only {
        display: block !important;
    }
}

/* ---- MCQ CONTROLS (avoids hidden+flex conflict) ---- */
#mcq-controls {
    /* JS controls via style.display: flex / none */
}

/* ---- SUBJECT PICKER BOTTOM SHEET ---- */
.subject-picker-overlay {
    position: fixed;
    inset: 0;
    z-index: 950;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    background: rgba(0,0,0,0.5);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    opacity: 0;
    transition: opacity 0.3s ease;
    padding-bottom: env(safe-area-inset-bottom, 0px);
}
.subject-picker-overlay.open {
    opacity: 1;
}
.subject-picker-overlay.hidden {
    pointer-events: none;
    visibility: hidden;
    opacity: 0;
}
/* When NOT hidden AND NOT open — transition state */
.subject-picker-overlay:not(.hidden) {
    visibility: visible;
}

#subject-picker-box {
    background: var(--surface);
    border-radius: 28px 28px 0 0;
    width: 100%;
    max-width: 560px;
    max-height: 82vh;
    overflow-y: auto;
    box-shadow: 0 -24px 64px rgba(0,0,0,0.22), 0 0 0 1px rgba(91,94,244,0.1);
    transform: translateY(100%);
    transition: transform 0.4s cubic-bezier(0.34,1.56,0.64,1);
    overscroll-behavior: contain;
    /* drag handle visual */
}
#subject-picker-box::before {
    content: '';
    display: block;
    width: 40px; height: 4px;
    border-radius: 99px;
    background: var(--text-3);
    opacity: 0.35;
    margin: 0.75rem auto 0;
}
.subject-picker-overlay.open #subject-picker-box {
    transform: translateY(0);
}

@media (min-width: 640px) {
    .subject-picker-overlay {
        align-items: center;
        padding: 1rem;
    }
    #subject-picker-box {
        border-radius: 24px;
        max-height: 72vh;
    }
    #subject-picker-box::before { display: none; }
}

.subject-picker-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    padding: 1rem 1.5rem 0.75rem;
    border-bottom: 1px solid rgba(0,0,0,0.07);
    position: sticky;
    top: 0;
    background: var(--surface);
    z-index: 2;
}
body.dark .subject-picker-header {
    border-bottom-color: rgba(255,255,255,0.06);
}
.subject-picker-header h3 {
    font-size: 1.05rem;
    font-weight: 700;
    color: var(--text);
}

.picker-close-btn {
    width: 32px; height: 32px;
    border-radius: 50%;
    border: none;
    background: var(--bg2);
    color: var(--text-2);
    cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    box-shadow: -2px -2px 4px var(--shadow-light), 2px 2px 4px var(--shadow-dark);
    transition: all var(--transition);
    flex-shrink: 0;
    margin-top: 0.1rem;
}
.picker-close-btn:hover {
    color: var(--accent-rose);
    background: rgba(244,63,94,0.1);
    transform: rotate(90deg);
}

.subject-picker-list {
    padding: 0.75rem 1rem 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 0.45rem;
}

.subject-picker-btn {
    display: flex;
    align-items: center;
    gap: 0.9rem;
    padding: 0.85rem 1rem;
    border-radius: 16px;
    border: 1.5px solid transparent;
    background: var(--bg2);
    cursor: pointer;
    text-align: left;
    width: 100%;
    font-family: 'Kalpurush', 'Inter', sans-serif;
    color: var(--text);
    transition: all 0.25s ease;
    box-shadow: inset 2px 2px 4px var(--shadow-dark), inset -2px -2px 4px var(--shadow-light);
    -webkit-tap-highlight-color: transparent;
}
.subject-picker-btn:hover {
    border-color: var(--accent);
    background: rgba(91,94,244,0.06);
    transform: translateX(4px);
    box-shadow: -4px -4px 8px var(--shadow-light), 4px 4px 8px var(--shadow-dark),
                0 4px 14px rgba(91,94,244,0.12);
}
.subject-picker-btn:active {
    transform: scale(0.98);
}

.picker-icon {
    font-size: 1.5rem;
    width: 44px; height: 44px;
    display: flex; align-items: center; justify-content: center;
    background: var(--surface);
    border-radius: 12px;
    box-shadow: -3px -3px 6px var(--shadow-light), 3px 3px 6px var(--shadow-dark);
    flex-shrink: 0;
    transition: transform var(--transition);
}
.subject-picker-btn:hover .picker-icon {
    transform: scale(1.08) rotate(-4deg);
}

.picker-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.1rem;
    min-width: 0;
}
.picker-name {
    font-weight: 700;
    font-size: 0.95rem;
    color: var(--text);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.picker-meta {
    font-size: 0.72rem;
    color: var(--text-3);
    font-weight: 600;
}
.picker-chevron {
    color: var(--text-3);
    flex-shrink: 0;
    transition: transform var(--transition), color var(--transition);
}
.subject-picker-btn:hover .picker-chevron {
    color: var(--accent);
    transform: translateX(4px);
}

/* ---- YEAR PICKER inside Subject Picker ---- */
.year-picker-wrap {
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
    padding: 0.5rem 1rem 1.5rem;
}
.year-picker-back {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.6rem 0.5rem;
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-2);
    background: none;
    border: none;
    cursor: pointer;
    font-family: 'Kalpurush','Inter',sans-serif;
    transition: color var(--transition);
}
.year-picker-back:hover { color: var(--accent); }
.year-btn {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.9rem 1.1rem;
    border-radius: 14px;
    border: 1.5px solid transparent;
    background: var(--bg2);
    cursor: pointer;
    font-family: 'Kalpurush','Inter',sans-serif;
    font-weight: 700;
    font-size: 1rem;
    color: var(--text);
    transition: all 0.25s ease;
    box-shadow: inset 2px 2px 4px var(--shadow-dark), inset -2px -2px 4px var(--shadow-light);
    -webkit-tap-highlight-color: transparent;
}
.year-btn:hover {
    border-color: var(--accent-4);
    background: rgba(16,185,129,0.06);
    transform: translateX(4px);
}
.year-btn-badge {
    font-size: 0.7rem;
    font-weight: 700;
    padding: 0.2rem 0.6rem;
    border-radius: 99px;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color: #fff;
}

/* ---- EMPTY STATE ---- */
#bookmarks-section .empty-state {
    text-align: center;
    padding: 3rem 1rem;
    color: var(--text-3);
}
#bookmarks-section .empty-state svg {
    margin: 0 auto 1rem;
    opacity: 0.4;
    display: block;
}

/* ---- MCQ CARD answered state ---- */
.mcq-card[data-revealed] {
    border-color: rgba(16,185,129,0.2) !important;
}

/* ==========================================================================
   UPGRADE v3.0 — Advanced Polish: Tables, Animations, SVG Icons, Dark Mode
   ========================================================================== */

/* ── ADVANCED TABLE DESIGN ── */
/* ── TABLE WRAPPER: Shadow-safe scroll
   Shadow থাকবে outer container-এ, scroll হবে inner-এ
   ফলে scroll করলেও shadow কখনো content-এর উপর পড়বে না ── */
.table-wrapper {
    /* Overflow বাইরের container-এ নয়, তাই shadow নিরাপদ */
    overflow: visible;
    border-radius: 18px !important;
    margin: 1.5rem 0 !important;
    position: relative;
    background: var(--surface) !important;
    /* Neumorphic shadow শুধু বাইরে থাকবে */
    box-shadow:
        0 0 0 1px rgba(91,94,244,0.15),
        0 6px 24px rgba(91,94,244,0.1),
        -5px -5px 10px var(--shadow-light),
        5px 5px 10px var(--shadow-dark) !important;
    /* Inner content clip করো — shadow ঠিক রেখে content trim */
    clip-path: inset(0 round 18px);
}
body.dark .table-wrapper {
    box-shadow:
        0 0 0 1px rgba(124,127,245,0.22),
        0 6px 24px rgba(0,0,0,0.35),
        -3px -3px 7px var(--shadow-light),
        3px 3px 7px var(--shadow-dark) !important;
}

/* Inner scrollable container — shadow-এর বাইরে overflow হয় */
.table-wrapper > .table-scroll-inner {
    overflow-x: auto;
    overflow-y: visible;
    -webkit-overflow-scrolling: touch;
    border-radius: 18px;
    position: relative;
    /* Scrollbar সুন্দর রাখো */
    scrollbar-width: thin;
    scrollbar-color: var(--accent) transparent;
}
.table-wrapper > .table-scroll-inner::-webkit-scrollbar {
    height: 4px;
}
.table-wrapper > .table-scroll-inner::-webkit-scrollbar-track {
    background: transparent;
}
.table-wrapper > .table-scroll-inner::-webkit-scrollbar-thumb {
    background: var(--accent);
    border-radius: 99px;
}

/* Fallback: যদি JS inner-wrap না করে, direct overflow */
.table-wrapper:not(:has(> .table-scroll-inner)) {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}

/* ── Scroll indicator: ডানে fade — shadow নয়, gradient overlay ── */
.table-wrapper::before {
    content: '';
    position: absolute;
    top: 0; right: 0; bottom: 0;
    width: 32px;
    background: linear-gradient(to left, var(--surface) 10%, transparent);
    pointer-events: none;
    border-radius: 0 18px 18px 0;
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 3;
}
.table-wrapper.has-overflow::before { opacity: 1; }

/* বাঁয়ে scroll হলে বাম দিকেও indicator */
.table-wrapper::after {
    content: '';
    position: absolute;
    top: 0; left: 0; bottom: 0;
    width: 32px;
    background: linear-gradient(to right, var(--surface) 10%, transparent);
    pointer-events: none;
    border-radius: 18px 0 0 18px;
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 3;
}
.table-wrapper.scrolled-right::after { opacity: 1; }

.answer-content table {
    width: 100%;
    border-collapse: separate !important;
    border-spacing: 0 !important;
    font-size: 0.875rem;
    font-variant-numeric: tabular-nums;
}

/* Header — background must be on <th> directly (not just thead tr)
   because border-collapse:separate breaks background inheritance in some browsers */
.answer-content thead tr {
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%) !important;
    position: sticky;
    top: 0;
    z-index: 2;
}
.answer-content th {
    padding: 0.85rem 1.1rem !important;
    text-align: left !important;
    /* ✅ FIX: background explicitly on th — prevents white header in light mode */
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%) !important;
    color: #fff !important;
    font-weight: 700 !important;
    font-size: 0.8rem !important;
    letter-spacing: 0.06em !important;
    text-transform: uppercase !important;
    white-space: nowrap !important;
    border-right: 1px solid rgba(255,255,255,0.18) !important;
    position: relative !important;
    /* Smooth transition for dark/light switch */
    transition: background 0.25s ease !important;
}
.answer-content th::after {
    content: '';
    position: absolute;
    bottom: 0; left: 0; right: 0;
    height: 2px;
    background: rgba(255,255,255,0.25);
}
.answer-content th:last-child { border-right: none !important; }

/* First header cell decoration */
.answer-content thead th:first-child {
    border-radius: 0 !important;
}

/* Body rows */
.answer-content td {
    padding: 0.72rem 1.1rem !important;
    border-bottom: 1px solid rgba(91,94,244,0.07) !important;
    border-right: 1px solid rgba(91,94,244,0.06) !important;
    color: var(--text) !important;
    vertical-align: middle !important;
    transition: background 0.18s ease, color 0.18s ease !important;
    line-height: 1.6 !important;
    position: relative !important;
}
.answer-content td:last-child { border-right: none !important; }
.answer-content tr:last-child td { border-bottom: none !important; }

/* Zebra stripes - more subtle and elegant */
.answer-content tbody tr:nth-child(even) td {
    background: rgba(91,94,244,0.035) !important;
}
body.dark .answer-content tbody tr:nth-child(even) td {
    background: rgba(124,127,245,0.05) !important;
}

/* Row hover - full row highlight */
@media (hover: hover) {
    .answer-content tbody tr:hover td {
        background: rgba(91,94,244,0.08) !important;
        color: var(--accent) !important;
    }
    .answer-content tbody tr:hover td:first-child {
        padding-left: 1.3rem !important;
    }
    .answer-content tbody tr { transition: all 0.15s ease; }
}

/* Dark mode table borders */
body.dark .answer-content td {
    border-color: rgba(124,127,245,0.1) !important;
}
body.dark .answer-content th {
    border-right-color: rgba(255,255,255,0.12) !important;
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%) !important;
    color: #fff !important;
}

/* Row number badge for first TD (optional via JS) */
.answer-content td:first-child {
    font-weight: 600;
}

/* Table row entrance animation */
.answer-content tbody tr {
    animation: tableRowIn 0.35s ease both;
}
.answer-content tbody tr:nth-child(2) { animation-delay: 0.04s; }
.answer-content tbody tr:nth-child(3) { animation-delay: 0.08s; }
.answer-content tbody tr:nth-child(4) { animation-delay: 0.12s; }
.answer-content tbody tr:nth-child(5) { animation-delay: 0.16s; }
.answer-content tbody tr:nth-child(n+6) { animation-delay: 0.2s; }
@keyframes tableRowIn {
    from { opacity: 0; transform: translateX(-6px); }
    to { opacity: 1; transform: translateX(0); }
}

/* ── SVG ICON CONTAINERS for subject picker (replacing emoji) ── */
.picker-icon {
    font-size: 1rem !important;
    width: 46px !important; height: 46px !important;
    display: flex !important; align-items: center !important; justify-content: center !important;
    background: var(--surface) !important;
    border-radius: 14px !important;
    box-shadow: -3px -3px 7px var(--shadow-light), 3px 3px 7px var(--shadow-dark) !important;
    flex-shrink: 0 !important;
    transition: transform var(--transition), box-shadow var(--transition) !important;
    color: var(--accent);
    overflow: hidden;
}
.picker-icon svg {
    width: 22px; height: 22px;
    stroke: currentColor;
    flex-shrink: 0;
}
.subject-picker-btn:hover .picker-icon {
    transform: scale(1.08) rotate(-5deg) !important;
    box-shadow: -4px -4px 10px var(--shadow-light), 4px 4px 10px var(--shadow-dark), 0 4px 14px rgba(91,94,244,0.18) !important;
}

/* Colored picker icons per subject */
.picker-icon.c-blue  { color: #3b82f6; }
.picker-icon.c-green { color: #10b981; }
.picker-icon.c-purple{ color: #8b5cf6; }
.picker-icon.c-cyan  { color: #06b6d4; }
.picker-icon.c-rose  { color: #f43f5e; }
.picker-icon.c-amber { color: #f59e0b; }
.picker-icon.c-indigo{ color: #6366f1; }
.picker-icon.c-teal  { color: #14b8a6; }
.picker-icon.c-orange{ color: #f97316; }
.picker-icon.c-pink  { color: #ec4899; }

/* ── NAV BUTTON: SVG colored icons ── */
#subject-nav .neu-btn .nav-icon {
    width: 18px; height: 18px;
    flex-shrink: 0;
    transition: transform var(--transition);
}
#subject-nav .neu-btn:hover .nav-icon,
#subject-nav .neu-btn.active .nav-icon {
    transform: scale(1.15) rotate(-5deg);
}

/* ── STAT ITEM: replace emoji icon with SVG ── */
.stat-item .s-icon-svg {
    width: 28px; height: 28px;
    margin: 0 auto 0.4rem;
    color: var(--accent);
    display: flex; align-items: center; justify-content: center;
    background: linear-gradient(135deg, rgba(91,94,244,0.12), rgba(139,92,246,0.12));
    border-radius: 10px;
    padding: 5px;
    box-shadow: -2px -2px 5px var(--shadow-light), 2px 2px 5px var(--shadow-dark);
}
.stat-item .s-icon-svg svg { width: 100%; height: 100%; }

/* ── TOAST: SVG icon ── */
.toast .t-icon-svg {
    width: 18px; height: 18px;
    flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
}
.toast .t-icon-svg.success-icon { color: var(--accent-4); }
.toast .t-icon-svg.warning-icon { color: var(--accent-warm); }
.toast .t-icon-svg.error-icon   { color: var(--accent-rose); }
.toast .t-icon-svg.info-icon    { color: var(--accent); }

/* ── MCQ: option icon replace textContent ✔/✖ with styled SVG ── */
.option-icon {
    margin-left: auto;
    flex-shrink: 0;
    width: 20px; height: 20px;
    display: flex; align-items: center; justify-content: center;
    border-radius: 50%;
    font-size: 0.75rem;
    transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1);
}
.mcq-option.correct .option-icon {
    background: var(--accent-4);
    color: #fff;
    transform: scale(1.2);
    box-shadow: 0 2px 8px rgba(16,185,129,0.45);
}
.mcq-option.incorrect .option-icon {
    background: var(--accent-rose);
    color: #fff;
    transform: scale(1.2);
    box-shadow: 0 2px 8px rgba(244,63,94,0.45);
}

/* ── NO-RESULTS: SVG icon ── */
.no-results .nr-icon-svg {
    width: 64px; height: 64px;
    margin: 0 auto 1rem;
    color: var(--text-3);
    opacity: 0.5;
    display: block;
}

/* ── ADVANCED ENTRANCE ANIMATIONS ── */

/* Slide-up-fade for cards/items */
@keyframes slideUpFade {
    from { opacity: 0; transform: translateY(20px) scale(0.97); }
    to   { opacity: 1; transform: translateY(0) scale(1); }
}

/* Card entrance for feature cards */
.feature-card {
    animation: slideUpFade 0.5s cubic-bezier(0.4,0,0.2,1) both;
}
.feature-card:nth-child(1) { animation-delay: 0.05s; }
.feature-card:nth-child(2) { animation-delay: 0.1s;  }
.feature-card:nth-child(3) { animation-delay: 0.15s; }
.feature-card:nth-child(4) { animation-delay: 0.2s;  }

/* Stat item stagger */
.stat-item {
    animation: slideUpFade 0.5s cubic-bezier(0.4,0,0.2,1) both;
}
.stat-item:nth-child(1) { animation-delay: 0.06s; }
.stat-item:nth-child(2) { animation-delay: 0.12s; }
.stat-item:nth-child(3) { animation-delay: 0.18s; }
.stat-item:nth-child(4) { animation-delay: 0.24s; }

/* Accordion reveal stagger (extended) */
.q-accordion.reveal-on-scroll:nth-child(6)  { transition-delay: 0.28s; }
.q-accordion.reveal-on-scroll:nth-child(7)  { transition-delay: 0.32s; }
.q-accordion.reveal-on-scroll:nth-child(8)  { transition-delay: 0.36s; }
.q-accordion.reveal-on-scroll:nth-child(9)  { transition-delay: 0.40s; }
.q-accordion.reveal-on-scroll:nth-child(10) { transition-delay: 0.44s; }

/* MCQ card stagger */
.mcq-card.reveal-on-scroll:nth-child(1) { transition-delay: 0s; }
.mcq-card.reveal-on-scroll:nth-child(2) { transition-delay: 0.05s; }
.mcq-card.reveal-on-scroll:nth-child(3) { transition-delay: 0.1s; }
.mcq-card.reveal-on-scroll:nth-child(4) { transition-delay: 0.15s; }
.mcq-card.reveal-on-scroll:nth-child(5) { transition-delay: 0.2s; }
.mcq-card.reveal-on-scroll:nth-child(n+6) { transition-delay: 0.25s; }

/* ── ADVANCED HOVER EFFECTS ── */

/* Accordion item: left border glow on hover */
.q-accordion::before {
    content: '';
    position: absolute;
    left: 0; top: 0; bottom: 0;
    width: 3px;
    background: linear-gradient(to bottom, var(--accent), var(--accent-2));
    border-radius: 0 0 0 18px;
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
}
.q-accordion:hover::before { opacity: 0.5; }
.q-accordion.is-open::before { opacity: 1 !important; }

/* MCQ option: no left stripe — চার পাশে সমান বর্ডার */
.mcq-option::before { display: none !important; }

/* ── FILTER SECTION UPGRADE ── */
.filter-wrap {
    position: relative;
    overflow: hidden;
}
.filter-wrap::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(91,94,244,0.03) 0%, rgba(139,92,246,0.03) 100%);
    pointer-events: none;
}

/* Year select: custom styled */
select.neu-select {
    appearance: none;
    -webkit-appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%235b5ef4' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.85rem center;
    padding-right: 2.2rem;
    cursor: pointer;
    transition: box-shadow var(--transition), border-color var(--transition), color var(--transition);
}
select.neu-select:hover {
    color: var(--accent);
    border-color: rgba(91,94,244,0.22);
}
select.neu-select:focus {
    outline: none;
    box-shadow: inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light),
                0 0 0 2px rgba(91,94,244,0.3);
    color: var(--accent);
}

/* ── SCROLLBAR UPGRADE ── */
::-webkit-scrollbar { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb {
    background: linear-gradient(var(--accent), var(--accent-2));
    border-radius: 99px;
}
::-webkit-scrollbar-thumb:hover {
    background: var(--accent-2);
}

/* ── FOCUS RING UPGRADE (accessibility) ── */
button:focus-visible,
[tabindex]:focus-visible,
input:focus-visible,
select:focus-visible {
    outline: 2px solid var(--accent) !important;
    outline-offset: 2px !important;
}

/* ── BODY TRANSITION (dark/light mode) ── */
body,
body * {
    transition-property: background-color, border-color, box-shadow, color;
    transition-duration: 0.25s;
    transition-timing-function: ease;
}
/* FIX: SVG ও তার child elements-কে global transition থেকে বাদ দিন
   নইলে Android Chrome-এ stroke/fill এ unexpected animation হয় */
svg, svg * {
    transition-property: none !important;
}
/* SVG যেগুলো explicitly animate করা দরকার সেগুলো আলাদাভাবে */
.bookmark-btn svg {
    transition: fill 0.25s ease, stroke 0.25s ease, transform 0.25s ease !important;
}
.q-chevron svg {
    transition: transform 0.3s cubic-bezier(0.4,0,0.2,1) !important;
}
/* Override slow transitions for elements that need faster or custom */
.toggle-thumb { transition: left 0.3s cubic-bezier(0.34,1.56,0.64,1), background 0.3s ease, box-shadow 0.3s ease !important; }
.q-body { transition: grid-template-rows 0.42s cubic-bezier(0.4,0,0.2,1), opacity 0.32s ease, padding 0.32s ease !important; }
.reveal-on-scroll { transition: opacity 0.55s cubic-bezier(0.4,0,0.2,1), transform 0.55s cubic-bezier(0.4,0,0.2,1) !important; }
#scroll-progress-bar { transition: width 0.1s linear !important; }

/* Disable transitions during theme switch for performance */
body.theme-switching * {
    transition: none !important;
}

/* ── SUBJECT NAV: icon-colored nav buttons ── */
#subject-nav .neu-btn .nav-icon-wrap {
    width: 22px; height: 22px;
    display: flex; align-items: center; justify-content: center;
    border-radius: 7px;
    background: linear-gradient(135deg, rgba(91,94,244,0.12), rgba(139,92,246,0.12));
    transition: all var(--transition);
    flex-shrink: 0;
}
#subject-nav .neu-btn.active .nav-icon-wrap {
    background: rgba(255,255,255,0.22);
}
#subject-nav .neu-btn:hover .nav-icon-wrap:not(.active) {
    background: rgba(91,94,244,0.18);
}

/* ── PROGRESS BAR UPGRADE ── */
.read-progress-bar-fill {
    background: linear-gradient(90deg, var(--accent-4), #34d399, var(--accent-3)) !important;
    background-size: 200% 100%;
    animation: progressShimmer 2s ease infinite;
}
@keyframes progressShimmer {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

/* ── MOBILE SPECIFIC UPGRADE ── */
@media (max-width: 640px) {
    /* Swipe-friendly larger touch targets */
    .mcq-option { min-height: 48px; }
    .neu-btn { min-height: 40px; }
    .q-header { min-height: 56px; }

    /* Table: horizontal scroll hint */
    .table-wrapper {
        border-radius: 14px !important;
    }
    .answer-content th { font-size: 0.72rem !important; padding: 0.65rem 0.85rem !important; }
    .answer-content td { font-size: 0.82rem !important; padding: 0.55rem 0.85rem !important; }

    /* Filter wrap: compact */
    .filter-wrap { border-radius: 16px !important; }

    /* FAB: bottom-right better position */
    #fab { bottom: 5rem; }

    /* Study timer: smaller on mobile */
    #study-timer { bottom: 1rem; right: 1rem; padding: 0.45rem 0.9rem; }

    /* FIX: মোবাইলে কম গুরুত্বপূর্ণ animations বন্ধ করা (GPU overload এড়াতে) */
    .sem-orb-ring-2 { animation: none; }
    .bg-glow::before { animation-duration: 30s; }
    .bg-glow::after  { animation-duration: 36s; }
    /* feature card float animation এ stagger কমানো */
    .fc-icon-wrap { animation-duration: 8s; }
}

/* FIX: will-change দিয়ে GPU layer তৈরি করা animated elements এ */
.sem-orb-ring,
.fc-icon-wrap,
.syllabus-header-icon {
    will-change: transform;
}
.bg-glow::before,
.bg-glow::after {
    will-change: transform;
}

/* ── DESKTOP SPECIFIC ── */
@media (min-width: 1024px) {
    #question-display { padding: 0 2rem 2rem; }
    .q-header { font-size: 1rem; padding: 1.1rem 1.4rem; }
    .answer-content { font-size: 0.98rem; padding: 1.4rem 1.3rem 0.9rem; }
    .mcq-card { padding: 1.2rem 1.4rem; }
}

/* ── CARD HOVER: 3D lift effect ── */
@media (hover: hover) and (pointer: fine) {
    .q-accordion {
        transform-style: preserve-3d;
    }
    .q-accordion:hover {
        transform: translateY(-3px) !important;
    }
    .q-accordion.is-open {
        transform: translateY(0) !important;
    }

    /* Feature card 3D tilt on hover */
    .feature-card-linked {
        transform-origin: center center;
        will-change: transform;
    }
}

/* ── GLASSMORPHISM PANEL UPGRADES ── */
#shortcut-box,
#subject-picker-box,
#modal-box {
    backdrop-filter: blur(20px) saturate(1.6);
    -webkit-backdrop-filter: blur(20px) saturate(1.6);
}

/* ── SEARCH DROPDOWN UPGRADE ── */
#search-results-dropdown {
    border: 1px solid rgba(91,94,244,0.12);
    animation: slideUpFade 0.2s ease;
}
body.dark #search-results-dropdown {
    border-color: rgba(124,127,245,0.15);
}
.search-result-item {
    cursor: pointer;
    transition: background 0.15s ease, padding-left 0.15s ease;
}
.search-result-item:hover { padding-left: 1.4rem; }

/* ── BOOKMARK BUTTON: animated fill on hover ── */
.bookmark-btn svg {
    transition: fill var(--transition), stroke var(--transition), transform var(--transition);
}
.bookmark-btn:hover svg {
    transform: scale(1.2) rotate(-5deg);
    fill: rgba(245,158,11,0.2);
    stroke: var(--accent-warm);
}
.bookmark-btn.bookmarked svg {
    fill: var(--accent-warm);
    stroke: var(--accent-warm);
}

/* ── TYPE FILTER BUTTONS (replacing emoji) ── */
.type-btn-icon {
    width: 16px; height: 16px;
    flex-shrink: 0;
}

/* ── NAV: subject button pills with gradient ── */
#subject-nav .neu-btn.active {
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%);
    color: #fff !important;
    border: none;
    box-shadow: 0 4px 16px rgba(91,94,244,0.38), 0 2px 6px rgba(91,94,244,0.22) !important;
}

/* ── HEADER ANIMATION ── */
header h1 {
    animation: headerSlideIn 0.8s cubic-bezier(0.34,1.56,0.64,1) both;
}
header p.subtitle {
    animation: headerSlideIn 0.8s 0.1s cubic-bezier(0.34,1.56,0.64,1) both;
}
@keyframes headerSlideIn {
    from { opacity: 0; transform: translateY(-12px); }
    to   { opacity: 1; transform: translateY(0); }
}

/* ── ACCORDION OPEN INDICATOR (animated dot) ── */
.q-accordion.is-open .q-header {
    background: linear-gradient(135deg, rgba(91,94,244,0.04) 0%, rgba(139,92,246,0.04) 100%);
}
body.dark .q-accordion.is-open .q-header {
    background: linear-gradient(135deg, rgba(124,127,245,0.06) 0%, rgba(167,139,250,0.06) 100%);
}

/* ── MCQ SCORE WRAP UPGRADE ── */
#mcq-score-wrap {
    background: var(--surface);
    border-radius: 18px;
    box-shadow: -5px -5px 10px var(--shadow-light), 5px 5px 10px var(--shadow-dark);
    transition: all var(--transition);
    overflow: hidden;
    position: relative;
}
#mcq-score-wrap::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--accent), var(--accent-2), var(--accent-3));
}

/* ── MOBILE: Better bottom spacing for FAB/timer ── */
@media (max-width: 640px) {
    main { padding-bottom: 5rem; }
}

/* ── PRINT STYLES ── */
@media print {
    #top-sticky-bar, #fab, #study-timer, #scroll-progress-bar,
    .bookmark-btn, .answer-actions, .ctx-menu { display: none !important; }
    .q-body { grid-template-rows: 1fr !important; padding: 0 1rem 1rem !important; opacity: 1 !important; }
    body { background: #fff !important; color: #000 !important; }
    .card, .q-accordion { box-shadow: none !important; border: 1px solid #ddd !important; }
}

/* ── ACCESSIBILITY: reduced motion ── */
@media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
    .bg-glow::before, .bg-glow::after { animation: none !important; }
}

/* ==========================================================================
   FINAL POLISH v4.0 — Advanced Icons, Animations, Syllabus, Dark Mode
   ========================================================================== */

/* ━━━ FEATURE CARD COMPLETE REDESIGN ━━━ */
.feature-card {
    background: var(--surface);
    border-radius: 20px;
    padding: 1.6rem 1.2rem 1.3rem;
    box-shadow: -6px -6px 14px var(--shadow-light), 6px 6px 14px var(--shadow-dark);
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    border: 1.5px solid transparent;
    text-align: center;
    display: flex; flex-direction: column; align-items: center;
    position: relative; overflow: hidden;
}
.feature-card::after {
    content: '';
    position: absolute; inset: 0;
    background: linear-gradient(135deg, transparent 60%, rgba(255,255,255,0.05) 100%);
    pointer-events: none;
}

/* Animated shimmer on top edge */
.feature-card::before {
    content: '';
    position: absolute; top: 0; left: -100%; right: 100%;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--accent), transparent);
    transition: left 0.5s ease, right 0.5s ease;
    border-radius: 99px;
}
.feature-card:hover::before { left: 0; right: 0; }

/* Icon wrap for new-style feature cards */
.fc-icon-wrap {
    width: 72px; height: 72px;
    border-radius: 20px;
    display: flex; align-items: center; justify-content: center;
    margin: 0 auto 1rem;
    position: relative;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: -4px -4px 10px var(--shadow-light), 4px 4px 10px var(--shadow-dark);
    animation: floatIcon 6s ease-in-out infinite;
}
.fc-icon-wrap svg {
    width: 44px; height: 44px;
    transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes floatIcon {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-5px); }
}

/* Color themes for icon wraps */
.fc-icon-blue  { background: linear-gradient(135deg, #dbeafe, #bfdbfe); color: #2563eb; }
.fc-icon-green { background: linear-gradient(135deg, #d1fae5, #a7f3d0); color: #059669; }
.fc-icon-purple{ background: linear-gradient(135deg, #ede9fe, #ddd6fe); color: #7c3aed; }
.fc-icon-amber { background: linear-gradient(135deg, #fef3c7, #fde68a); color: #d97706; }

body.dark .fc-icon-blue  { background: linear-gradient(135deg, rgba(59,130,246,0.2), rgba(37,99,235,0.15)); color: #60a5fa; }
body.dark .fc-icon-green { background: linear-gradient(135deg, rgba(16,185,129,0.2), rgba(5,150,105,0.15)); color: #34d399; }
body.dark .fc-icon-purple{ background: linear-gradient(135deg, rgba(139,92,246,0.2), rgba(124,58,237,0.15)); color: #a78bfa; }
body.dark .fc-icon-amber { background: linear-gradient(135deg, rgba(245,158,11,0.2), rgba(217,119,6,0.15)); color: #fbbf24; }

.feature-card-linked:hover .fc-icon-wrap {
    transform: scale(1.12) rotate(-5deg) translateY(-4px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.15), -5px -5px 12px var(--shadow-light), 5px 5px 12px var(--shadow-dark);
}
.feature-card-linked:hover .fc-icon-wrap svg { transform: scale(1.1) rotate(5deg); }

/* Specific card color accents on hover */
.fc-chart:hover { border-color: rgba(37,99,235,0.3); box-shadow: -8px -8px 18px var(--shadow-light), 8px 8px 18px var(--shadow-dark), 0 16px 40px rgba(37,99,235,0.12); }
.fc-mcq:hover   { border-color: rgba(5,150,105,0.3); box-shadow: -8px -8px 18px var(--shadow-light), 8px 8px 18px var(--shadow-dark), 0 16px 40px rgba(5,150,105,0.12); }
.fc-search:hover{ border-color: rgba(124,58,237,0.3); box-shadow: -8px -8px 18px var(--shadow-light), 8px 8px 18px var(--shadow-dark), 0 16px 40px rgba(124,58,237,0.12); }
.fc-bookmark:hover { border-color: rgba(217,119,6,0.3); box-shadow: -8px -8px 18px var(--shadow-light), 8px 8px 18px var(--shadow-dark), 0 16px 40px rgba(217,119,6,0.12); }

/* Stagger icon float delays */
.fc-chart .fc-icon-wrap    { animation-delay: 0s; }
.fc-mcq .fc-icon-wrap      { animation-delay: 1.5s; }
.fc-search .fc-icon-wrap   { animation-delay: 3s; }
.fc-bookmark .fc-icon-wrap { animation-delay: 4.5s; }

/* ━━━ WELCOME CARD UPGRADE ━━━ */
.welcome-text {
    font-size: clamp(1.3rem, 4vw, 1.8rem);
    font-weight: 700;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    margin-bottom: 0.4rem;
}
.welcome-sub {
    font-size: 0.9rem;
    color: var(--text-2);
    max-width: 480px;
    margin: 0 auto 1.5rem;
    line-height: 1.65;
}

/* ━━━ SYLLABUS SECTION — COMPLETE REDESIGN ━━━ */
#syllabus-section {
    padding: 0 1rem 2rem;
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
}

.syllabus-header {
    display: flex;
    align-items: center;
    gap: 0.85rem;
    margin-bottom: 2rem;
    padding: 1.5rem 1.75rem;
    background: var(--surface);
    border-radius: 20px;
    box-shadow: -6px -6px 14px var(--shadow-light), 6px 6px 14px var(--shadow-dark);
    border: 1.5px solid rgba(91,94,244,0.1);
    position: relative;
    overflow: hidden;
}
.syllabus-header::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; height: 3px;
    background: linear-gradient(90deg, var(--accent), var(--accent-2), var(--accent-3));
}
.syllabus-header-icon {
    width: 48px; height: 48px;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    border-radius: 14px;
    display: flex; align-items: center; justify-content: center;
    color: #fff;
    box-shadow: 0 4px 16px rgba(91,94,244,0.4);
    flex-shrink: 0;
    animation: floatIcon 5s ease-in-out infinite;
}
.syllabus-header-text h2 {
    font-size: 1.35rem;
    font-weight: 700;
    color: var(--text);
}
.syllabus-header-text p {
    font-size: 0.8rem;
    color: var(--text-3);
    margin-top: 0.15rem;
}

/* Syllabus Subject Cards Grid */
.syllabus-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 1rem;
    margin-bottom: 1.75rem;
}

/* Subject Card (replaces boring syl-btn) */
.syl-btn {
    background: var(--surface);
    border: 2px solid transparent;
    border-radius: 18px;
    padding: 1.1rem 1rem 0.9rem;
    cursor: pointer;
    font-family: 'Kalpurush', 'Inter', sans-serif;
    font-size: 0.83rem;
    font-weight: 600;
    color: var(--text-2);
    text-align: center;
    box-shadow: -5px -5px 10px var(--shadow-light), 5px 5px 10px var(--shadow-dark);
    transition: all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
    line-height: 1.4;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.65rem;
    position: relative;
    overflow: hidden;
}
.syl-btn::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 3px;
    background: linear-gradient(90deg, var(--accent), var(--accent-2));
    transform: scaleX(0);
    transition: transform 0.35s ease;
    border-radius: 2px 2px 0 0;
}
.syl-btn:hover::before, .syl-btn.active::before { transform: scaleX(1); }

.syl-btn-icon {
    width: 48px; height: 48px;
    border-radius: 14px;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
    background: linear-gradient(135deg, rgba(91,94,244,0.08), rgba(139,92,246,0.08));
    color: var(--accent);
}
.syl-btn-icon svg { width: 26px; height: 26px; }

.syl-btn-label {
    font-size: 0.82rem;
    line-height: 1.35;
    color: var(--text-2);
    transition: color 0.25s ease;
}

.syl-btn:hover {
    border-color: rgba(91,94,244,0.2);
    color: var(--text);
    transform: translateY(-4px);
    box-shadow: -6px -6px 14px var(--shadow-light), 6px 6px 14px var(--shadow-dark), 0 12px 28px rgba(91,94,244,0.12);
}
.syl-btn:hover .syl-btn-icon {
    transform: scale(1.1) rotate(-5deg);
    background: linear-gradient(135deg, rgba(91,94,244,0.15), rgba(139,92,246,0.15));
}
.syl-btn:hover .syl-btn-label { color: var(--accent); }

.syl-btn.active {
    border-color: var(--accent);
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color: #fff;
    box-shadow: 0 8px 24px rgba(91,94,244,0.4), 0 2px 8px rgba(91,94,244,0.25);
    transform: translateY(-2px);
}
.syl-btn.active .syl-btn-icon {
    background: rgba(255,255,255,0.2);
    color: #fff;
    transform: scale(1.05);
}
.syl-btn.active .syl-btn-label { color: rgba(255,255,255,0.92); }

/* Colored subject-specific syl-btns */
.syl-btn[data-key="bangla"]:not(.active) .syl-btn-icon         { color: #2563eb; background: rgba(37,99,235,0.1); }
.syl-btn[data-key="english"]:not(.active) .syl-btn-icon         { color: #059669; background: rgba(5,150,105,0.1); }
.syl-btn[data-key="ict"]:not(.active) .syl-btn-icon             { color: #0891b2; background: rgba(8,145,178,0.1); }
.syl-btn[data-key="shikkhaMonobiggan"]:not(.active) .syl-btn-icon { color: #7c3aed; background: rgba(124,58,237,0.1); }
.syl-btn[data-key="ict_in_edu"]:not(.active) .syl-btn-icon      { color: #4f46e5; background: rgba(79,70,229,0.1); }
.syl-btn[data-key="genderEducation"]:not(.active) .syl-btn-icon  { color: #db2777; background: rgba(219,39,119,0.1); }
.syl-btn[data-key="organizationManagement"]:not(.active) .syl-btn-icon { color: #ea580c; background: rgba(234,88,12,0.1); }
.syl-btn[data-key="bangla_paper_2"]:not(.active) .syl-btn-icon  { color: #e11d48; background: rgba(225,29,72,0.1); }
.syl-btn[data-key="english_paper_2"]:not(.active) .syl-btn-icon { color: #0d9488; background: rgba(13,148,136,0.1); }
.syl-btn[data-key="ict_education_2"]:not(.active) .syl-btn-icon { color: #d97706; background: rgba(217,119,6,0.1); }

/* Syllabus Content Box */
.syllabus-content-box {
    background: var(--surface);
    border-radius: 22px;
    padding: 0;
    box-shadow: -6px -6px 14px var(--shadow-light), 6px 6px 14px var(--shadow-dark);
    border: 1.5px solid rgba(91,94,244,0.12);
    overflow: hidden;
    animation: slideUpFade 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}
body.dark .syllabus-content-box { border-color: rgba(124,127,245,0.18); }

/* Syllabus content panel */
#syllabus-content {
    padding: 1.75rem 1.75rem 1.5rem;
}
#syllabus-content h1, #syllabus-content h2 {
    font-size: 1.08rem;
    font-weight: 700;
    color: var(--accent);
    margin: 1.35rem 0 0.7rem;
    padding-bottom: 0.4rem;
    border-bottom: 2px solid rgba(91,94,244,0.13);
    display: flex; align-items: center; gap: 0.5rem;
}
body.dark #syllabus-content h2 { color: var(--accent-2); border-bottom-color: rgba(167,139,250,0.2); }
#syllabus-content h2:first-child { margin-top: 0; }
#syllabus-content h3 {
    font-size: 0.97rem;
    font-weight: 700;
    color: var(--text);
    margin: 1.1rem 0 0.5rem;
    display: flex; align-items: center; gap: 0.4rem;
}
#syllabus-content h3::before {
    content: '';
    display: inline-block;
    width: 6px; height: 6px;
    border-radius: 50%;
    background: var(--accent);
    flex-shrink: 0;
}
#syllabus-content p {
    font-size: 0.93rem;
    line-height: 1.8;
    color: var(--text-2);
    margin-bottom: 0.85rem;
}
#syllabus-content ul, #syllabus-content ol {
    padding-left: 1.5rem;
    margin-bottom: 1rem;
}
#syllabus-content li {
    font-size: 0.92rem;
    line-height: 1.75;
    color: var(--text-2);
    margin-bottom: 0.4rem;
    position: relative;
}
#syllabus-content li::marker { color: var(--accent); }
#syllabus-content strong { color: var(--accent); font-weight: 700; }
body.dark #syllabus-content strong { color: #c4b5fd; }
#syllabus-content table { width: 100%; }

/* Syllabus content tab header */
.syl-content-header {
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%);
    padding: 1.25rem 1.75rem;
    display: flex; align-items: center; gap: 1rem;
    position: relative;
}
.syl-content-header::after {
    content: '';
    position: absolute; bottom: 0; left: 0; right: 0; height: 1px;
    background: rgba(255,255,255,0.15);
}
.syl-content-title {
    flex: 1;
}
.syl-content-title h3 {
    font-size: 1rem; font-weight: 700; color: #fff;
    margin: 0;
}
.syl-content-title p {
    font-size: 0.75rem; color: rgba(255,255,255,0.75);
    margin: 0.15rem 0 0;
}
.syl-content-badge {
    background: rgba(255,255,255,0.2);
    border: 1px solid rgba(255,255,255,0.25);
    border-radius: 99px;
    padding: 0.25rem 0.75rem;
    font-size: 0.7rem;
    font-weight: 700;
    color: #fff;
    letter-spacing: 0.06em;
    backdrop-filter: blur(4px);
    flex-shrink: 0;
}
.syl-content-icon {
    width: 42px; height: 42px;
    background: rgba(255,255,255,0.2);
    border-radius: 12px;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
    color: #fff;
}
.syl-content-icon svg { width: 22px; height: 22px; }

/* ━━━ ADVANCED SUBJECT NAV ICONS ━━━ */
#subject-nav .neu-btn {
    font-size: 0.83rem;
}
#subject-nav .neu-btn .nav-icon-wrap {
    width: 24px; height: 24px;
    border-radius: 8px;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    flex-shrink: 0;
    overflow: hidden;
}
#subject-nav .neu-btn.active .nav-icon-wrap {
    background: rgba(255,255,255,0.25) !important;
    transform: rotate(-5deg) scale(1.1);
}
#subject-nav .neu-btn:hover:not(.active) .nav-icon-wrap {
    transform: rotate(-5deg) scale(1.15);
}

/* Subject nav color backgrounds */
#subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-blue   { background: rgba(59,130,246,0.12); color: #2563eb; }
#subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-green  { background: rgba(16,185,129,0.12); color: #059669; }
#subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-purple { background: rgba(139,92,246,0.12); color: #7c3aed; }
#subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-cyan   { background: rgba(6,182,212,0.12);  color: #0891b2; }
#subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-rose   { background: rgba(244,63,94,0.12);  color: #e11d48; }
#subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-amber  { background: rgba(245,158,11,0.12); color: #d97706; }
#subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-indigo { background: rgba(99,102,241,0.12); color: #4f46e5; }
#subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-teal   { background: rgba(20,184,166,0.12); color: #0d9488; }
#subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-orange { background: rgba(249,115,22,0.12); color: #ea580c; }
#subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-pink   { background: rgba(236,72,153,0.12); color: #db2777; }

body.dark #subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-blue   { background: rgba(59,130,246,0.2); color: #60a5fa; }
body.dark #subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-green  { background: rgba(16,185,129,0.2); color: #34d399; }
body.dark #subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-purple { background: rgba(139,92,246,0.2); color: #a78bfa; }
body.dark #subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-cyan   { background: rgba(6,182,212,0.2);  color: #22d3ee; }
body.dark #subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-rose   { background: rgba(244,63,94,0.2);  color: #fb7185; }
body.dark #subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-amber  { background: rgba(245,158,11,0.2); color: #fbbf24; }
body.dark #subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-orange { background: rgba(249,115,22,0.2); color: #fb923c; }
body.dark #subject-nav .neu-btn:not(.active) .nav-icon-wrap.c-pink   { background: rgba(236,72,153,0.2); color: #f472b6; }

/* ━━━ DARK MODE CONTRAST UPGRADES ━━━ */
body.dark {
    --text: #edf2ff;
    --text-2: #9dafc8;
    --text-3: #5d7290;
}
body.dark .feature-card h3 { color: #edf2ff; }
body.dark .feature-card p   { color: #9dafc8; }
body.dark .stat-item .s-label { color: #9dafc8; }
body.dark .filter-group label { color: #9dafc8; }
body.dark .q-header { color: #edf2ff; }
body.dark .answer-content { color: #dce4f5; }
body.dark .syl-btn-label { color: #9dafc8; }
body.dark .syllabus-header-text h2 { color: #edf2ff; }
body.dark .syllabus-header-text p  { color: #5d7290; }
body.dark #syllabus-content p  { color: #bdd0e8; }
body.dark #syllabus-content li { color: #bdd0e8; }
body.dark .welcome-sub { color: #9dafc8; }
body.dark .mcq-q-text  { color: #edf2ff; }
body.dark .opt-letter  { color: #9dafc8; }
body.dark .mcq-option  { color: #d8e5f5; }
body.dark .syl-toggle-btn { color: var(--accent-2); border-color: var(--accent-2); }
body.dark .syl-toggle-btn:hover { background: var(--accent-2); color: #fff; }

/* ━━━ HOVER GLOW EFFECT ON STATS ━━━ */
.stat-item {
    position: relative;
    overflow: hidden;
}
.stat-item::after {
    content: '';
    position: absolute; inset: 0;
    background: radial-gradient(circle at center, rgba(91,94,244,0.06) 0%, transparent 70%);
    opacity: 0;
    transition: opacity 0.35s ease;
    pointer-events: none;
    border-radius: inherit;
}
.stat-item:hover::after { opacity: 1; }

/* ━━━ SMOOTH BG GLOW — THIRD ORBS ━━━ */
.bg-glow {
    position: fixed; inset: 0; pointer-events: none; z-index: 0; overflow: hidden;
}
.bg-glow::before, .bg-glow::after { content: ''; position: absolute; border-radius: 50%; }

/* ━━━ READING PROGRESS BAR ━━━ */
.read-progress-wrap {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    margin-bottom: 1rem;
    padding: 0.6rem 0.8rem;
    background: var(--surface);
    border-radius: 10px;
    box-shadow: -3px -3px 6px var(--shadow-light), 3px 3px 6px var(--shadow-dark);
}
.read-progress-bar-track {
    flex: 1;
    height: 6px;
    background: var(--bg2);
    border-radius: 99px;
    overflow: hidden;
    box-shadow: inset 1px 1px 3px var(--shadow-dark);
}
.read-progress-label {
    font-size: 0.7rem;
    font-weight: 700;
    color: var(--text-3);
    white-space: nowrap;
    flex-shrink: 0;
}

/* ━━━ PREMIUM HEADER BADGE REDESIGN ━━━ */
.header-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.45rem;
    font-size: 0.7rem;
    font-weight: 800;
    letter-spacing: 0.13em;
    text-transform: uppercase;
    padding: 0.45rem 1.25rem;
    border-radius: 99px;
    background: var(--surface);
    color: var(--accent);
    margin-bottom: 0.85rem;
    position: relative;
    overflow: hidden;
    box-shadow:
        -5px -5px 10px var(--shadow-light),
        5px 5px 10px var(--shadow-dark),
        inset 0 0 0 1.5px rgba(99,102,241,0.3);
    animation: badgePop 0.6s cubic-bezier(0.34,1.56,0.64,1) both, headerBadgePulse 4s 2s ease-in-out infinite;
}
/* gradient tint overlay */
.header-badge::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(110deg,
        rgba(99,102,241,0.1) 0%,
        rgba(139,92,246,0.07) 50%,
        rgba(99,102,241,0.1) 100%);
    border-radius: inherit;
    pointer-events: none;
}
/* shimmer sweep */
.header-badge::after {
    content: '';
    position: absolute;
    top: 0; left: -100%;
    width: 60%;
    height: 100%;
    background: linear-gradient(90deg,
        transparent 0%,
        rgba(255,255,255,0.35) 50%,
        transparent 100%);
    transform: skewX(-20deg);
    animation: badgeShimmer 4s 2.5s ease-in-out infinite;
    pointer-events: none;
}
@keyframes badgeShimmer {
    0%   { left: -100%; opacity: 0; }
    10%  { opacity: 1; }
    50%  { left: 140%; opacity: 1; }
    51%, 100% { left: 140%; opacity: 0; }
}
/* dot accent before text */
.header-badge .badge-dot {
    width: 6px; height: 6px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    box-shadow: 0 0 6px rgba(99,102,241,0.6);
    flex-shrink: 0;
    animation: dotPulse 2s ease-in-out infinite;
}
@keyframes dotPulse {
    0%, 100% { transform: scale(1); box-shadow: 0 0 6px rgba(99,102,241,0.6); }
    50%       { transform: scale(1.35); box-shadow: 0 0 10px rgba(99,102,241,0.9); }
}
body.dark .header-badge {
    color: #a5b4fc;
    box-shadow:
        -4px -4px 8px var(--shadow-light),
        4px 4px 8px var(--shadow-dark),
        inset 0 0 0 1.5px rgba(139,92,246,0.35);
}
body.dark .header-badge::before {
    background: linear-gradient(110deg,
        rgba(99,102,241,0.15) 0%,
        rgba(139,92,246,0.1) 50%,
        rgba(99,102,241,0.15) 100%);
}


/* ━━━ MCQ OPTION — শান্ত ট্রানজিশন (কোনো ঝাঁকি নেই) ━━━ */
.mcq-option {
    transition: all 0.35s cubic-bezier(0.4,0,0.2,1) !important;
    animation: none !important;
}
.mcq-option.correct  { animation: none !important; }
.mcq-option.incorrect { animation: none !important; }

/* ━━━ ENHANCED ACCORDION OPEN STATE ━━━ */
.q-accordion.is-open {
    border-color: rgba(91,94,244,0.28);
    box-shadow:
        -4px -4px 10px var(--shadow-light),
        4px 4px 10px var(--shadow-dark),
        0 0 0 1.5px rgba(91,94,244,0.15),
        0 16px 40px rgba(91,94,244,0.12),
        inset 0 1px 0 rgba(255,255,255,0.08);
}

/* ━━━ IMPROVED SCROLLBAR ━━━ */
::-webkit-scrollbar { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb {
    background: linear-gradient(var(--accent), var(--accent-2));
    border-radius: 99px;
}

/* ━━━ CHART SECTION HEADER ━━━ */
#chart-section .card h3 {
    color: var(--text);
    letter-spacing: -0.01em;
}
body.dark #chart-section .card h3 { color: #edf2ff; }

/* ━━━ BETTER FILTER WRAP ━━━ */
.filter-wrap {
    background: var(--surface);
    border-radius: 18px;
    padding: 0.85rem 1.25rem;
    box-shadow: -5px -5px 12px var(--shadow-light), 5px 5px 12px var(--shadow-dark);
    border: 1.5px solid rgba(91,94,244,0.07);
    position: relative;
    overflow: hidden;
}
body.dark .filter-wrap { border-color: rgba(124,127,245,0.12); }

/* ━━━ EMPTY STATES ━━━ */
.empty-state p, .no-results p {
    color: var(--text-2);
    font-size: 0.92rem;
    line-height: 1.65;
}
body.dark .empty-state p,
body.dark .no-results p { color: #9dafc8; }

/* ━━━ MODAL / SHEETS — improved contrast ━━━ */
#shortcut-box kbd {
    background: var(--bg2);
    color: var(--text);
    border: 1px solid rgba(91,94,244,0.2);
    border-radius: 6px;
    padding: 0.15rem 0.55rem;
    font-family: 'Inter', monospace;
    font-size: 0.72rem;
    font-weight: 600;
    box-shadow: 0 2px 0 rgba(91,94,244,0.2);
}
body.dark #shortcut-box kbd { color: #edf2ff; background: var(--bg2); border-color: rgba(124,127,245,0.25); }
.sk-label { color: var(--text-2); font-size: 0.87rem; }
body.dark .sk-label { color: #9dafc8; }

/* ━━━ HOME STATS ICON CONTAINER FIX ━━━ */
.stat-item .s-icon-svg {
    width: 32px; height: 32px;
    margin: 0 auto 0.5rem;
    color: var(--accent);
    display: flex; align-items: center; justify-content: center;
    background: linear-gradient(135deg, rgba(91,94,244,0.1), rgba(139,92,246,0.1));
    border-radius: 10px;
    padding: 5px;
    box-shadow: -2px -2px 4px var(--shadow-light), 2px 2px 4px var(--shadow-dark);
    transition: all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.stat-item:hover .s-icon-svg {
    transform: scale(1.1) rotate(-5deg);
    background: linear-gradient(135deg, rgba(91,94,244,0.18), rgba(139,92,246,0.18));
}

/* ━━━ RESPONSE ANIMATIONS — SMOOTH LOAD ━━━ */
@keyframes sectionFadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to   { opacity: 1; transform: translateY(0); }
}
#syllabus-section:not(.hidden),
#bookmarks-section:not(.hidden),
#filter-section:not(.hidden) {
    animation: sectionFadeIn 0.4s ease both;
}

/* ━━━ SYLLABUS CONTENT TRANSLATE TOGGLE ━━━ */
.syl-toggle-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.55rem 1.2rem;
    border-radius: 99px;
    border: 2px solid var(--accent);
    background: transparent;
    color: var(--accent);
    font-family: 'Kalpurush', 'Inter', sans-serif;
    font-size: 0.82rem;
    font-weight: 700;
    cursor: pointer;
    margin-top: 1.25rem;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 4px 12px rgba(91,94,244,0.15);
}
.syl-toggle-btn:hover {
    background: var(--accent);
    color: #fff;
    transform: translateY(-2px);
    box-shadow: 0 8px 22px rgba(91,94,244,0.38);
}

/* ━━━ SEARCH RESULT: better dark contrast ━━━ */
body.dark .search-result-item { background: var(--surface-2); }
body.dark .search-result-item:hover { background: rgba(124,127,245,0.1); }
body.dark .search-result-item .sr-q { color: #d8e5f5; }
body.dark .search-result-item .sr-meta { color: #5d7290; }

/* ━━━ CONTEXT MENU: dark contrast ━━━ */
body.dark #ctx-menu { background: var(--surface-2); }
body.dark .ctx-item  { color: #d8e5f5; }

/* ━━━ PULSE RING ANIMATION FOR ACTIVE MCQ ━━━ */
@keyframes pulseRing {
    0%   { box-shadow: 0 0 0 0 rgba(91,94,244,0.4); }
    70%  { box-shadow: 0 0 0 10px rgba(91,94,244,0); }
    100% { box-shadow: 0 0 0 0 rgba(91,94,244,0); }
}

/* ━━━ SUBJECT CARD COLOR THEMES for syl-btn ━━━ */
.syl-btn.syl-blue   { --syl-accent: #2563eb; }
.syl-btn.syl-green  { --syl-accent: #059669; }
.syl-btn.syl-purple { --syl-accent: #7c3aed; }
.syl-btn.syl-cyan   { --syl-accent: #0891b2; }
.syl-btn.syl-rose   { --syl-accent: #e11d48; }
.syl-btn.syl-amber  { --syl-accent: #d97706; }
.syl-btn.syl-orange { --syl-accent: #ea580c; }
.syl-btn.syl-pink   { --syl-accent: #db2777; }
.syl-btn.syl-teal   { --syl-accent: #0d9488; }

/* Apply themed hover border */
.syl-btn.active, .syl-btn:hover {
    border-color: var(--syl-accent, var(--accent));
}
.syl-btn.active {
    background: linear-gradient(135deg, var(--syl-accent, var(--accent)), var(--accent-2, #8b5cf6));
}
.syl-btn::before {
    background: linear-gradient(90deg, var(--syl-accent, var(--accent)), var(--accent-2));
}

/* ━━━ FOOTER ━━━ */
footer .brand { 
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    font-weight: 700;
}
body.dark footer { color: #5d7290; }

/* ━━━ RESPONSIVE POLISHING ━━━ */
@media (max-width: 640px) {
    .syllabus-grid { grid-template-columns: repeat(2, 1fr); gap: 0.75rem; }
    .syl-btn { padding: 0.85rem 0.65rem; }
    .syl-btn-icon { width: 40px; height: 40px; }
    .syl-btn-icon svg { width: 22px; height: 22px; }
    .fc-icon-wrap { width: 60px; height: 60px; }
    .fc-icon-wrap svg { width: 36px; height: 36px; }
    .syllabus-header { padding: 1rem 1.25rem; }
    #syllabus-content { padding: 1.25rem 1.25rem 1rem; }
    .syl-content-header { padding: 1rem 1.25rem; }
}
@media (min-width: 640px) {
    .syllabus-grid { grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); }
}
@media (min-width: 1024px) {
    .syllabus-grid { grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); }
}


/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   CREATIVE SEM HERO BADGE  ✦  Full Redesign
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
.sem-hero-badge {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1.2rem;
    /* FIX: inset negative rings (-26px) মোবাইলে বাইরে যায়,
       margin দিয়ে জায়গা নিশ্চিত করা হয়েছে */
    margin-top: 32px;
    cursor: default;
}

/* Outer pulsing orbital rings */
.sem-orb-ring {
    position: absolute;
    inset: -14px;
    border-radius: 50px;
    border: 1.5px solid rgba(99,102,241,0.18);
    animation: orbRingSpin 8s linear infinite;
    pointer-events: none;
}
.sem-orb-ring::before {
    content: '';
    position: absolute;
    top: -4px; left: 50%;
    width: 8px; height: 8px;
    margin-left: -4px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    box-shadow: 0 0 8px rgba(99,102,241,0.8);
}
.sem-orb-ring-2 {
    inset: -26px;
    border-color: rgba(139,92,246,0.1);
    animation: orbRingSpin 14s linear infinite reverse;
    border-style: dashed;
}
.sem-orb-ring-2::before {
    background: linear-gradient(135deg, var(--accent-2), var(--accent-3));
    box-shadow: 0 0 6px rgba(139,92,246,0.7);
    width: 6px; height: 6px;
    margin-left: -3px;
}
@keyframes orbRingSpin {
    from { transform: rotate(0deg); }
    to   { transform: rotate(360deg); }
}

/* Main badge body */
.sem-badge-inner {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.3rem;
    padding: 0.75rem 2rem;
    border-radius: 20px;
    background: var(--surface);
    box-shadow:
        -6px -6px 14px var(--shadow-light),
        6px 6px 14px var(--shadow-dark),
        inset 0 0 0 1.5px rgba(99,102,241,0.22);
    animation: badgePop 0.7s cubic-bezier(0.34,1.56,0.64,1) both;
    overflow: hidden;
    min-width: 220px;
}

/* shimmer sweep on badge */
.sem-badge-inner::after {
    content: '';
    position: absolute;
    top: 0; left: -100%; width: 60%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.28), transparent);
    transform: skewX(-18deg);
    animation: badgeShimmer 5s 1.5s ease-in-out infinite;
    pointer-events: none;
}

/* Top micro label */
.sem-label-top {
    font-size: 0.58rem;
    font-weight: 700;
    letter-spacing: 0.22em;
    text-transform: uppercase;
    color: var(--text-3);
    position: relative;
    padding: 0 0.5rem;
}
.sem-label-top::before,
.sem-label-top::after {
    content: '';
    position: absolute;
    top: 50%;
    width: 28px; height: 1px;
    background: linear-gradient(90deg, transparent, rgba(99,102,241,0.4));
}
.sem-label-top::before { right: 100%; }
.sem-label-top::after  { left: 100%; transform: scaleX(-1); }

/* Main number + text row */
.sem-number-row {
    display: flex;
    align-items: center;
    gap: 0.85rem;
    /* FIX: romanGlow এর drop-shadow এখানে রাখা হয়েছে যাতে
       gradient text ঠিকমতো দেখায় সব ব্রাউজারে
       (.sem-roman এ filter দিলে Android Chrome-এ gradient text ভাঙে) */
    filter: drop-shadow(0 2px 8px rgba(99,102,241,0.28));
    animation: romanGlow 3s ease-in-out infinite;
    will-change: filter;
}

/* Big Roman numeral */
.sem-roman {
    font-size: 2.8rem;
    font-weight: 900;
    line-height: 1;
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 50%, var(--accent-3) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: -0.02em;
    /* FIX: filter এখানে নেই — parent (.sem-number-row) এ আছে
       filter+gradient-text একসাথে Android Chrome-এ ভাঙে */
}
@keyframes romanGlow {
    0%, 100% { filter: drop-shadow(0 2px 8px rgba(99,102,241,0.28)); }
    50%       { filter: drop-shadow(0 2px 16px rgba(139,92,246,0.5)); }
}

/* Vertical divider */
.sem-divider-v {
    width: 1.5px;
    height: 42px;
    background: linear-gradient(to bottom, transparent, rgba(99,102,241,0.4), transparent);
    border-radius: 99px;
}

/* Text column */
.sem-text-col {
    display: flex;
    flex-direction: column;
    gap: 0.15rem;
    text-align: left;
}
.sem-word-top {
    font-size: 0.85rem;
    font-weight: 800;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--accent);
    line-height: 1;
}
.sem-word-bot {
    font-size: 0.78rem;
    font-weight: 600;
    color: var(--text-2);
    letter-spacing: 0.04em;
    line-height: 1;
}

/* Bottom label with dots */
.sem-label-bot {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.6rem;
    font-weight: 600;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--text-3);
}
.sem-dot-sm {
    width: 4px; height: 4px;
    border-radius: 50%;
    background: var(--accent-2);
    opacity: 0.6;
}

/* Dark mode adjustments */
body.dark .sem-badge-inner {
    box-shadow:
        -5px -5px 12px var(--shadow-light),
        5px 5px 12px var(--shadow-dark),
        inset 0 0 0 1.5px rgba(139,92,246,0.28);
}
body.dark .sem-orb-ring {
    border-color: rgba(139,92,246,0.25);
}
body.dark .sem-orb-ring-2 {
    border-color: rgba(99,102,241,0.15);
}

/* Mobile responsive */
@media (max-width: 480px) {
    .sem-badge-inner  { padding: 0.6rem 1.5rem; min-width: 180px; }
    .sem-roman        { font-size: 2.2rem; }
    .sem-orb-ring     { inset: -10px; }
    .sem-orb-ring-2   { inset: -20px; }
    /* FIX: ছোট inset মানে কম overflow, মার্জিনও কমানো যায় */
    .sem-hero-badge   { margin-top: 24px !important; }
}

/* ━━━ 4th superscript styling ━━━ */
.sem-th {
    font-size: 1.1rem;
    font-weight: 900;
    vertical-align: super;
    line-height: 1;
    letter-spacing: 0.04em;
    background: linear-gradient(135deg, var(--accent-2), var(--accent-3));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   SMART SPACE MANAGEMENT  ✦  Compact Home Layout
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */

/* Header: tighter top padding */
header { padding: 1rem 1rem 0.5rem !important; }

/* Sem badge: less bottom gap */
.sem-hero-badge { margin-bottom: 0.6rem !important; margin-top: 32px !important; }

/* h1 title: snugger */
header h1 { margin-bottom: 0.1rem !important; }

/* Subtitle: less gap below */
header p.subtitle { margin-top: 0.2rem !important; margin-bottom: 0 !important; }

/* Subject nav: compact */
#subject-nav {
    padding: 0.4rem 1rem !important;
    margin: 0.2rem auto !important;
    gap: 0.45rem !important;
}
#subject-nav .neu-btn { padding: 0.38rem 0.85rem !important; font-size: 0.82rem !important; }

/* Intro card: tighter padding */
#intro-section { margin-top: 0.4rem !important; }
#intro-section > .card { padding: 1.25rem 1.5rem !important; margin-bottom: 0.75rem !important; }

/* Welcome text: compact */
#intro-section .welcome-text { margin-bottom: 0.25rem !important; }
#intro-section .welcome-sub  { margin-bottom: 1rem !important; }

/* Feature cards grid gap */
#intro-section .grid { gap: 0.75rem !important; margin-top: 0.5rem !important; }

/* Feature card icons: slightly smaller */
.fc-icon-wrap { width: 60px !important; height: 60px !important; margin-bottom: 0.6rem !important; }
.fc-icon-wrap svg { width: 30px !important; height: 30px !important; }

/* Stats bar: compact */
#stats-bar { margin-bottom: 0.85rem !important; gap: 0.65rem !important; }
.stat-item  { padding: 0.7rem 0.9rem !important; }
.stat-item .s-num { font-size: 1.5rem !important; }

/* Home stats grid */
#home-stats { margin-bottom: 0.75rem !important; gap: 0.65rem !important; }

/* ─── Responsive: tablet+ only compact ring ─── */
@media (min-width: 768px) {
    header { padding: 1.2rem 1rem 0.6rem !important; }
    .sem-hero-badge { margin-bottom: 0.8rem !important; }
    #subject-nav { padding: 0.5rem 1rem !important; gap: 0.5rem !important; }
    #intro-section > .card { padding: 1.5rem 2rem !important; }
}

/* ==========================================================================
   FINE-TUNING PATCH — Light mode table fix + Smooth polish
   ========================================================================== */

/* ── TABLE HEADER: Universal Fix (light + dark) ──
   Ensures gradient always shows regardless of collapse mode or browser */
.answer-content thead th,
.answer-content table thead tr th {
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-2) 100%) !important;
    color: #fff !important;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
}

/* Force table-wrapper background to match surface — prevents bleedthrough */
.table-wrapper {
    background: var(--surface) !important;
    overflow: visible !important;
    clip-path: inset(0 round 18px) !important;
}
.table-scroll-inner {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
}

/* ── SMOOTH SECTION TRANSITIONS ── */
#intro-section,
#filter-section,
#question-display,
#syllabus-section,
#bookmarks-section,
#chart-section,
#progress-section {
    transition: opacity 0.3s ease, transform 0.3s ease;
}

/* ── BUTTON ACTIVE FEEDBACK — instant press feel ── */
.neu-btn,
.syl-btn,
.subject-picker-btn,
.year-btn {
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
}

/* ── SELECT OPTION — dark mode text fix ── */
body.dark select option {
    background: var(--surface);
    color: var(--text);
}

/* ── SEARCH INPUT — autocomplete bg fix ── */
#global-search:-webkit-autofill,
#global-search:-webkit-autofill:focus {
    -webkit-box-shadow: 0 0 0 1000px var(--surface) inset !important;
    -webkit-text-fill-color: var(--text) !important;
    transition: background-color 5000s ease-in-out 0s;
}

/* ── ACCORDION: prevent layout shift on open/close ── */
.q-accordion {
    contain: layout style;
    will-change: box-shadow, border-color;
}

/* ── MCQ OPTION: smooth border radius on mobile ── */
.mcq-option {
    -webkit-appearance: none;
}

/* ── FILTER WRAP: prevent content overflow ── */
.filter-wrap {
    min-width: 0;
}
.filter-group {
    min-width: 0;
    flex-shrink: 1;
}

/* ── SMOOTH SCROLL for anchor links ── */
html {
    scroll-behavior: smooth;
    scroll-padding-top: 72px; /* account for sticky bar height */
}

/* ── STICKY BAR: ensure it covers content below ── */
#top-sticky-bar {
    isolation: isolate;
}

/* ── TOAST: prevent overflow on very small screens ── */
#toast-container {
    max-width: calc(100vw - 3rem);
}
@media (max-width: 400px) {
    #toast-container {
        right: 0.75rem;
        bottom: 1rem;
    }
    .toast {
        font-size: 0.8rem;
        padding: 0.65rem 0.9rem;
    }
}

/* ── MODAL: smooth bottom sheet on all heights ── */
#modal-box {
    overscroll-behavior: contain;
    -webkit-overflow-scrolling: touch;
}

/* ── CHART: canvas anti-aliasing ── */
#chart-section canvas {
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
}

/* ── PROGRESS FILL: shimmer only when active ── */
.read-progress-bar-fill:not([style*="width: 0"]) {
    animation: progressShimmer 2.5s ease infinite;
}

/* ── Q-BODY: no layout reflow during animation ── */
.q-body > * {
    min-height: 0;
    contain: none;
}

/* ── FEATURE CARD: prevent text overflow on small screens ── */
.feature-card h3 {
    word-break: keep-all;
    overflow-wrap: break-word;
}

/* ── BOOKMARKS: empty state padding ── */
#bookmarks-section .empty-state {
    min-height: 200px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

/* ── SYLLABUS content: smoother paragraph spacing ── */
#syllabus-content p + p {
    margin-top: 0;
}
#syllabus-content ul li + li,
#syllabus-content ol li + li {
    margin-top: 0.2rem;
}

/* ── Answer content: better code/pre styling ── */
.answer-content code {
    background: rgba(91,94,244,0.08);
    color: var(--accent);
    padding: 0.15rem 0.4rem;
    border-radius: 5px;
    font-family: 'Inter', monospace;
    font-size: 0.85em;
    font-weight: 600;
}
body.dark .answer-content code {
    background: rgba(124,127,245,0.15);
    color: var(--accent-2);
}
.answer-content pre {
    background: rgba(91,94,244,0.04);
    border: 1px solid rgba(91,94,244,0.1);
    border-radius: 10px;
    padding: 1rem;
    overflow-x: auto;
    margin: 0.75rem 0;
}

/* ── HEADING animations: only when section enters ── */
.answer-content h2:first-child,
.answer-content h1:first-child {
    margin-top: 0;
}

/* ── Search dropdown: better scrollbar ── */
#search-results-dropdown::-webkit-scrollbar { width: 4px; }
#search-results-dropdown::-webkit-scrollbar-thumb {
    background: var(--accent);
    border-radius: 99px;
}

/* ── Shortcut box heading ── */
#shortcut-box h3 {
    font-size: 1rem;
    font-weight: 700;
    color: var(--text);
    margin-bottom: 1rem;
    padding-bottom: 0.6rem;
    border-bottom: 1px solid rgba(91,94,244,0.12);
}
body.dark #shortcut-box h3 {
    border-bottom-color: rgba(124,127,245,0.15);
}

/* ── FAB tooltip on desktop ── */
@media (hover: hover) and (pointer: fine) {
    #fab::after {
        content: attr(title);
        position: absolute;
        left: calc(100% + 10px);
        top: 50%;
        transform: translateY(-50%);
        background: var(--surface-2);
        color: var(--text);
        font-size: 0.75rem;
        font-weight: 600;
        white-space: nowrap;
        padding: 0.35rem 0.75rem;
        border-radius: 8px;
        box-shadow: 0 4px 14px rgba(0,0,0,0.15);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s ease;
        font-family: 'Kalpurush', 'Inter', sans-serif;
    }
    #fab:hover::after {
        opacity: 1;
    }
}

/* ── Table: first column always visible on overflow scroll ── */
@media (max-width: 640px) {
    .answer-content td:first-child,
    .answer-content th:first-child {
        min-width: 80px;
    }
}

/* ── Stat number: prevent reflow during count-up ── */
.s-num {
    min-width: 1.5rem;
    display: inline-block;
    text-align: center;
}

/* ── Global image rendering ── */
img {
    display: block;
    max-width: 100%;
}

/* ==========================================================================
   POLISHED PATCH v5.0 — All fixes consolidated, no conflicts
   ========================================================================== */

/* ── Meta text (bookmarks/notes) — dark mode aware ── */
.bm-meta {
    color: var(--text-3);
    font-size: 0.72rem;
    font-weight: 600;
}
.picker-empty-msg {
    color: var(--text-3);
    font-size: 0.9rem;
    font-family: 'Kalpurush', 'Inter', sans-serif;
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   ACCORDION SPACING — উত্তরের নিচের ফাঁকা কমানো
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   Stack analysis (top → bottom):
     answer-content padding-bottom  : 0.75rem  (base)
     answer-actions margin-top       : 1rem     (base)
     answer-actions padding-top      : 1rem     (base)
     q-body.open padding-bottom      : 1.5rem   (base)
     ─────────────────────────────────────────────────
     Total bottom gap                : ~4.25rem  ← too much

   Target (with action buttons present):
     answer-content padding-bottom   : 0
     answer-actions margin-top        : 0.45rem
     answer-actions padding-top       : 0.45rem
     q-body.open padding-bottom       : 0.55rem
     ─────────────────────────────────────────────────
     Total bottom gap                 : ~1.45rem  ← natural
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */

/* answer-content — শেষ child .answer-actions হলে bottom padding শূন্য */
.answer-content {
    padding-bottom: 0 !important;
}

/* শেষ paragraph/list/heading এর margin-bottom শূন্য */
.answer-content > p:last-of-type,
.answer-content > ul:last-child,
.answer-content > ol:last-child,
.answer-content > h2:last-child,
.answer-content > h3:last-child,
.answer-content > .table-wrapper:last-child {
    margin-bottom: 0 !important;
}

/* body content পরিমিত spacing */
.answer-content p    { margin-bottom: 0.72rem !important; }
.answer-content li   { margin-bottom: 0.32rem !important; }
.answer-content h1,
.answer-content h2   { margin: 0.95rem 0 0.45rem !important; }
.answer-content h3   { margin: 0.8rem 0 0.38rem !important; }
.answer-content h1:first-child,
.answer-content h2:first-child { margin-top: 0 !important; }

/* ── answer-actions row — tight but breathable ── */
.answer-actions {
    padding-top: 0.45rem !important;
    margin-top:  0.45rem !important;
    padding-bottom: 0 !important;
    margin-bottom:  0 !important;
    gap: 0.38rem !important;
}

/* ── q-body open — এখন action row নিজেই নিচের border ── */
.q-body.open {
    padding: 0 1.25rem 0.55rem !important;
}

/* ── Mobile ── */
@media (max-width: 640px) {
    .answer-content {
        padding: 0.88rem 0.82rem 0 !important;
        font-size: 0.92rem !important;
        line-height: 1.76 !important;
    }
    .answer-content p { text-align: left !important; hyphens: none !important; }
    .q-body.open { padding: 0 0.82rem 0.45rem !important; }
    .answer-actions {
        padding-top: 0.38rem !important;
        margin-top:  0.38rem !important;
        gap: 0.3rem !important;
    }
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   ACCORDION POLISH
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
.q-accordion {
    border-radius: 18px !important;
    will-change: box-shadow;
    transition: box-shadow 0.28s ease, border-color 0.28s ease, transform 0.18s ease !important;
}
@media (hover: hover) and (pointer: fine) {
    .q-accordion:hover { transform: translateY(-1px); }
}
.q-body {
    transition:
        grid-template-rows 0.36s cubic-bezier(0.4,0,0.2,1),
        opacity 0.26s ease,
        padding 0.26s ease !important;
}
.q-chevron {
    transition: transform 0.32s cubic-bezier(0.4,0,0.2,1),
                background 0.22s ease,
                box-shadow 0.22s ease !important;
    flex-shrink: 0 !important;
}
.q-header { padding: 0.88rem 1.05rem !important; gap: 0.65rem !important; }
@media (max-width: 640px) {
    .q-header { padding: 0.78rem 0.88rem !important; font-size: 0.89rem !important; }
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   MCQ OPTION POLISH
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
.mcq-option {
    transition: background 0.2s ease, border-color 0.2s ease,
                color 0.2s ease, transform 0.16s ease, box-shadow 0.2s ease !important;
    will-change: transform, background;
}
.mcq-option:active { transform: scale(0.975) !important; }
@media (hover: none) {
    .mcq-option:hover {
        transform: none !important;
        border-color: transparent !important;
        background: var(--bg2) !important;
        color: var(--text) !important;
    }
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   DARK MODE: MCQ correct/incorrect
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
body.dark .mcq-option.correct {
    background: rgba(16,185,129,0.15) !important;
    color: #6ee7b7 !important;
    border-color: rgba(16,185,129,0.5) !important;
}
body.dark .mcq-option.incorrect {
    background: rgba(244,63,94,0.13) !important;
    color: #fca5a5 !important;
    border-color: rgba(244,63,94,0.45) !important;
}
body.dark .mcq-option { color: var(--text); }

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   DARK MODE: Action buttons
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
body.dark .answer-actions { border-top-color: rgba(124,127,245,0.15) !important; }
body.dark .action-btn {
    border-color: rgba(124,127,245,0.2) !important;
    background: rgba(124,127,245,0.06) !important;
    color: var(--text-3) !important;
}
body.dark .action-btn:hover {
    border-color: var(--accent-2) !important;
    color: var(--accent-2) !important;
    background: rgba(124,127,245,0.12) !important;
}
body.dark .action-btn.read-done {
    border-color: var(--accent-4) !important;
    color: var(--accent-4) !important;
    background: rgba(16,185,129,0.1) !important;
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   DARK MODE: Search, Table, general
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
body.dark #search-results-dropdown {
    background: var(--surface-2);
    box-shadow: 0 20px 60px rgba(0,0,0,0.45), 0 0 0 1px rgba(124,127,245,0.18);
}
body.dark .search-result-item { border-bottom-color: rgba(255,255,255,0.05); }
body.dark .search-result-item:hover,
body.dark .search-result-item.focused { background: rgba(124,127,245,0.1); }
body.dark mark { background: rgba(124,127,245,0.25); color: var(--accent-2); }
body.dark .table-wrapper { background: var(--surface-2) !important; }
body.dark .answer-content td {
    background: var(--surface-2);
    color: var(--text) !important;
    border-color: rgba(124,127,245,0.1) !important;
}
body.dark .answer-content tbody tr:nth-child(even) td {
    background: rgba(124,127,245,0.07) !important;
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   SCROLL PROGRESS BAR
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
#scroll-progress-bar {
    height: 3px !important;
    border-radius: 0 99px 99px 0;
    will-change: width;
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   REVEAL ANIMATION — subtler, faster
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
.reveal-on-scroll {
    opacity: 0;
    transform: translateY(14px) !important;
    transition: opacity 0.4s cubic-bezier(0.4,0,0.2,1),
                transform 0.4s cubic-bezier(0.4,0,0.2,1) !important;
}
.reveal-on-scroll.is-visible { opacity: 1 !important; transform: translateY(0) !important; }

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   TOAST
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
.toast {
    backdrop-filter: blur(12px) !important;
    -webkit-backdrop-filter: blur(12px) !important;
    border: 1px solid rgba(99,102,241,0.12) !important;
}
body.dark .toast {
    border-color: rgba(124,127,245,0.18) !important;
    background: rgba(33,37,58,0.95) !important;
}
@keyframes toastIn {
    from { transform: translateX(50px) scale(0.95); opacity: 0; }
    to   { transform: translateX(0) scale(1); opacity: 1; }
}
@keyframes toastOut {
    from { transform: translateX(0) scale(1); opacity: 1; }
    to   { transform: translateX(50px) scale(0.95); opacity: 0; }
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   NEU-BTN focus & active
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
.neu-btn:focus-visible {
    outline: 2.5px solid var(--accent);
    outline-offset: 2px;
}
.neu-btn:active {
    transform: translateY(1px) scale(0.974) !important;
    transition-duration: 0.08s !important;
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   MOBILE: no sticky hover
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
@media (hover: none) {
    .neu-btn:hover,
    .q-accordion:hover,
    .mcq-card:hover,
    .stat-item:hover,
    .feature-card:hover {
        transform: none !important;
        box-shadow: inherit !important;
    }
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   MOBILE: keyboard shortcut panel hidden
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
@media (hover: none), (pointer: coarse) {
    #shortcut-panel,
    #shortcut-panel.open {
        pointer-events: none !important;
        opacity: 0 !important;
    }
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   iOS safe area
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
@supports (padding-bottom: env(safe-area-inset-bottom)) {
    #fab       { bottom: calc(1.25rem + env(safe-area-inset-bottom, 0px)); }
    #study-timer { bottom: calc(1.25rem + env(safe-area-inset-bottom, 0px)); }
}

/* ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   GLOBAL PERFORMANCE
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ */
html { scrollbar-gutter: stable; }
body {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
}
.card, .mcq-card { will-change: box-shadow; transform: translateZ(0); }
#top-sticky-bar  { will-change: backdrop-filter; transform: translateZ(0); }
#fab             { will-change: transform, opacity; }
